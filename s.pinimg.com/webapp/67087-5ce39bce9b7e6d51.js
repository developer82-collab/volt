"use strict";(self.legacyJsonp=self.legacyJsonp||[]).push([["67087"],{297723:function(e,t,n){n.r(t);var r={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"CloseupVideoEndCard_pin",selections:[{args:null,kind:"FragmentSpread",name:"useCalculateMaxWidthAndHeightForSideBySideVariant_pin"}],type:"Pin",abstractKey:null};r.hash="e04be51b4be0a2585e7803d004fa83b7",t.default=r},842246:function(e,t,n){n.r(t);var r={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"CloseupVideoNonDuplo_pin",selections:[{args:null,kind:"FragmentSpread",name:"CloseupVideoEndCard_pin"},{args:null,kind:"FragmentSpread",name:"VideoWithContextLogging_pin"},{args:null,kind:"FragmentSpread",name:"useCalculateMaxWidthAndHeightForSideBySideVariant_pin"}],type:"Pin",abstractKey:null};r.hash="53ae9ecd15f057f744460205e5d495fd",t.default=r},77947:function(e,t,n){n.r(t);var r={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"StoryPinBlock_pin",selections:[{args:null,kind:"FragmentSpread",name:"StoryPinStickerBlockCloseup_pin"}],type:"Pin",abstractKey:null};r.hash="8bb1bb1f7bafeed0fe43bed44ef12d2a",t.default=r},511849:function(e,t,n){n.r(t);var r={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"StoryPinStickerBlockCloseup_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gridTitle",storageKey:null},{alias:"imageSpec_236x",args:[{kind:"Literal",name:"spec",value:"236x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null}],storageKey:'images(spec:"236x")'},{alias:null,args:null,concreteType:"RichPinGridData",kind:"LinkedField",name:"richSummary",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"displayName",storageKey:null},{alias:null,args:null,concreteType:"RichPinProductMetadata",kind:"LinkedField",name:"products",plural:!0,selections:[{alias:null,args:null,concreteType:"OfferSummary",kind:"LinkedField",name:"offerSummary",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"price",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"maxPrice",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Pin",abstractKey:null};r.hash="7e8d917850c8329247291df0d281a59b",t.default=r},917628:function(e,t,n){n.r(t);var r={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useCalculateImageContainerDimension_pin",selections:[{args:null,kind:"FragmentSpread",name:"useCalculateMaxWidthAndHeightForSideBySideVariant_pin"}],type:"Pin",abstractKey:null};r.hash="86a6c49cecdb70d77f786a1965756cf9",t.default=r},82852:function(e,t,n){n.r(t);var r,i,o,a,l=(r={alias:null,args:null,kind:"ScalarField",name:"domain",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"link",storageKey:null},a=[{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"officialUser",plural:!1,selections:o=[{alias:null,args:null,kind:"ScalarField",name:"firstName",storageKey:null}],storageKey:null}],{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useCalculateMaxWidthAndHeightForSideBySideVariant_pin",selections:[{alias:null,args:null,concreteType:"PinCarouselData",kind:"LinkedField",name:"carouselData",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"index",storageKey:null},{alias:null,args:null,concreteType:"PinCarouselSlot",kind:"LinkedField",name:"carouselSlots",plural:!0,selections:[r,i],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"closeupAttribution",plural:!1,selections:o,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"closeupUnifiedTitle",storageKey:null},r,{alias:null,args:null,kind:"ScalarField",name:"gridTitle",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isEligibleForPdp",storageKey:null},i,{alias:null,args:null,concreteType:"Domain",kind:"LinkedField",name:"linkDomain",plural:!1,selections:a,storageKey:null},{alias:null,args:null,concreteType:"UserWebsite",kind:"LinkedField",name:"linkUserWebsite",plural:!1,selections:a,storageKey:null},{alias:null,args:null,concreteType:"RichPinDataView",kind:"LinkedField",name:"richMetadata",plural:!1,selections:[{alias:null,args:null,concreteType:"RichPinProductMetadata",kind:"LinkedField",name:"products",plural:!0,selections:[{alias:null,args:null,concreteType:"OfferSummary",kind:"LinkedField",name:"offerSummary",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"price",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"standardPrice",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"trackedLink",storageKey:null}],type:"Pin",abstractKey:null});l.hash="b2a27d44d1f3dbd42301b82866212272",t.default=l},768576:function(e,t,n){var r=n(387784),i=n(20256),o=n(113759),a=n(680811);function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}t.Z=(0,r.forwardRef)(function(e,t){var n,s=e.accessibilityControls,u=e.accessibilityExpanded,c=e.accessibilityHaspopup,d=e.accessibilityLabel,p=e.handleClick,f=e.icon,h=e.iconColor,m=e.iconOnly,y=e.testId,g=e.buttonText,v=e.tabIndex,b=e.bgColor,_=e.isActive,x=e.size,P=function(e){if(Array.isArray(e))return e}(n=(0,r.useState)(!1))||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,l=[],s=!0,u=!1;try{for(o=(n=n.call(e)).next;!(s=(r=o.call(n)).done)&&(l.push(r.value),2!==l.length);s=!0);}catch(e){u=!0,i=e}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return l}}(n,2)||function(e,t){if(e){if("string"==typeof e)return l(e,2);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,2):void 0}}(n,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),S=P[0],w=P[1],O=(0,r.useRef)(null);(0,r.useImperativeHandle)(t,function(){return O.current});var j=(0,o.x4)().setAbortNoActionPlacementTimeout,E=function(){w(function(e){return!e}),p(),j(!0)},C=function(e){var t;O&&e.target instanceof Element&&!(null!=(t=O.current)&&t.contains(e.target))&&w(!1)};return(0,r.useEffect)(function(){return window.addEventListener("mousedown",C),function(){window.removeEventListener("mousedown",C)}},[]),(0,r.useEffect)(function(){void 0!==_&&w(_)},[_]),(0,a.jsx)(i.xu,{"data-test-id":y||"closeup-action-bar-button",children:(0,a.jsxs)(i.kC,{alignItems:"center",justifyContent:"start",children:[(0,a.jsx)(i.hU,{ref:O,accessibilityControls:s,accessibilityExpanded:u,accessibilityHaspopup:c,accessibilityLabel:d,bgColor:b,icon:f,iconColor:h||"darkGray",onClick:E,selected:S,size:x||(m?"md":"lg"),tabIndex:v}),g&&(0,a.jsx)(i.iP,{onTap:E,rounding:2,children:(0,a.jsx)(i.X6,{color:"light",overflow:"normal",size:"400",children:g})})]})})})},578377:function(e,t,n){n.d(t,{S:function(){return r}});var r=1e3;t.Z=3},800691:function(e,t,n){n.d(t,{ZP:function(){return y},GJ:function(){return m}});var r,i=n(387784);n(204306);var o=n(788730),a=n(514793),l=n(928585),s=n(200301),u=n(183e3),c=n(15392),d=n(113759);function p(e){return function(e){if(Array.isArray(e))return f(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return f(e,void 0);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,void 0):void 0}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var h=(void 0!==r||(r=n(917628)).hash&&"86a6c49cecdb70d77f786a1965756cf9"!==r.hash&&console.error("The definition of 'useCalculateImageContainerDimension_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),r);function m(e,t){return"".concat(Math.floor(e/t*1e4)/1e4," / 1")}function y(e){var t=e.carouselData,n=e.imageToDisplayWidthRatio,r=void 0===n?1:n,f=e.mainImage,m=void 0===f?{width:1,height:1,url:""}:f,y=e.maxCloseupImageWidth,g=e.pinKey,v=e.shouldPadImage,b=void 0!==v&&v,_=(0,u.Z)(h,g),x=(0,d.x4)(),P=x.peekCloseupEnabled,S=x.viewportSize,w=(0,o.Re)().numericValues,O=(0,a.Z)({pinKey:_}).maxHeight,j=null!=w?w:{},E=j.fiftyPercentHeight,C=j.fiftyPercentWidth,T=j.maxHeight,A=j.maxWidth,I=(0,l.Z)(m).peekRedesignFastFollowsEnabled;return(0,i.useMemo)(function(){var e,n,i,o,a,l,u,d=y-c.d2,f=Math.min(b?d:y,null!=A?A:1/0,null!=C?C:1/0),h=(n=[m].concat(p((null==t||null==(e=t.carousel_slots)?void 0:e.map(function(e){var t,n,r,i,o,a;return(0,s.Z)(e.images)||((n=null==(t=e.videos)?void 0:t.video_list)?null!=(r=n.V_720P)&&r.url?n.V_720P:null!=(i=n.V_HLSV4)&&i.url?n.V_HLSV4:null!=(o=n.V_HLSV3_MOBILE)&&o.url?n.V_HLSV3_MOBILE:null!=(a=n.V_HLSV3_WEB)&&a.url?n.V_HLSV3_WEB:null:null)}).filter(function(e){return!!e}))||[])).map(function(e){var t=e.width,n=e.height;return(null!=t?t:1)/(null!=n?n:1)}),Math.min.apply(Math,p(n))),g=Math.floor(f*(t?r:1)/h),v="sm"===S?E:T;u=P?null!=v?v:g:"number"==typeof O?O:g;var _=I?void 0:u,x=_?Math.min(g,_):g,w=Math.min(f*(P?x/g:1),null!=A?A:1/0,null!=C?C:1/0),j=((a=(null==m?void 0:m.width)/m.height)>(l=w/x)?(i=w,o=w/a):(i=x*a,o=x),{containerAspectRatio:l,letterBoxedWidth:i,letterBoxedHeight:o}),k=j.containerAspectRatio,R=j.letterBoxedWidth,M=j.letterBoxedHeight;return{containerAspectRatio:k,containerHeight:x,containerWidth:w,horizontalOffset:(w-R)/2,letterBoxedHeight:M,letterBoxedWidth:R,letterBoxAspectRatio:R/M,verticalOffset:(x-M)/2}},[y,b,m,t,r,S,E,T,P,O,I,A,C])}},261978:function(e,t){t.Z=function(e,t){var n,r=t||{},i=r.height,o=r.width;switch(e){case"enabled_15":n=.15;break;case"enabled_25":n=.25;break;default:n=.35}return(void 0===o?0:o)/(void 0===i?0:i)<n}},690070:function(e,t,n){n.d(t,{Z:function(){return w}});var r=n(387784),i=n(20256),o=n(788730),a=n(514793),l=n(70806),s=n(230201),u=n(24246),c=n(780268),d=n(975703),p=n(113759),f=n(680811);function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach(function(t){x(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function g(e,t){return(g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function v(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(b=function(){return!!e})()}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function x(e,t,n){return(t=P(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function P(e){var t=function(e,t){if("object"!=h(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=h(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==h(t)?t:t+""}var S=function(e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");o.prototype=Object.create(e&&e.prototype,{constructor:{value:o,writable:!0,configurable:!0}}),Object.defineProperty(o,"prototype",{writable:!1}),e&&g(o,e);var t,n,r=(t=b(),function(){var e,n=_(o);return e=t?Reflect.construct(n,arguments,_(this).constructor):n.apply(this,arguments),function(e,t){if(t&&("object"==h(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return v(e)}(this,e)});function o(){var e;if(!(this instanceof o))throw TypeError("Cannot call a class as a function");for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];return x(v(e=r.call.apply(r,[this].concat(n))),"startAudiblePlayTime",e.props.muted?null:new Date),e}return n=[{key:"componentDidUpdate",value:function(e){e.muted!==this.props.muted&&(this.startAudiblePlayTime=this.props.muted?null:new Date)}},{key:"componentWillUnmount",value:function(){var e=this.props,t=e.musicRecordingId,n=e.muted,r=e.pinId,i=e.video;if(t&&!n&&this.startAudiblePlayTime&&Date.now()-this.startAudiblePlayTime.getTime()>=2e3){var o,a,l,s,u,d,p,f=(0,c.Z)({vEXP3:null==(o=i.video_list)?void 0:o.V_EXP3,vEXP4:null==(a=i.video_list)?void 0:a.V_EXP4,vEXP5:null==(l=i.video_list)?void 0:l.V_EXP5,vEXP6:null==(s=i.video_list)?void 0:s.V_EXP6,vEXP7:null==(u=i.video_list)?void 0:u.V_EXP7,v720P:null==(d=i.video_list)?void 0:d.V_720P,vHLSV3MOBILE:null==(p=i.video_list)?void 0:p.V_HLSV3_MOBILE})||{},h=f.hlsv3,m=f.mp4||h,y=(null==m?void 0:m.duration)||0;this.props.logContextEvent({event_type:8999,object_id_str:t,aux_data:{pin_id:r,story_pin_music_duration:y}})}}},{key:"render",value:function(){var e,t,n,r,o,a,s,u,d,p=this.props,h=p.activePageIndex,m=p.aspectRatio,y=p.blockHeight,g=p.blockWidth,v=p.closeupBodyWidth,b=p.closeupStoryPinViewability,_=p.closeupWithinMasonryEnabled,x=p.customEndCard,P=p.isPlaying,S=p.muted,w=p.onEnded,O=p.onUpdateVideoInfo,j=p.pageIndex,E=p.pin,C=p.pinId,T=p.maxHeight,A=p.video,I=p.videoThumbnailStartTime,k=null!=(e=(0,c.Z)({vEXP3:null==(t=A.video_list)?void 0:t.V_EXP3,vEXP4:null==(n=A.video_list)?void 0:n.V_EXP4,vEXP5:null==(r=A.video_list)?void 0:r.V_EXP5,vEXP6:null==(o=A.video_list)?void 0:o.V_EXP6,vEXP7:null==(a=A.video_list)?void 0:a.V_EXP7,v720P:null==(s=A.video_list)?void 0:s.V_720P,vHLSV3MOBILE:null==(u=A.video_list)?void 0:u.V_HLSV3_MOBILE}))?e:{},R=k.hlsv3,M=k.mp4,D=M||R;if(!D)return null;var L=D.height,F=D.thumbnail,z=D.width,V=null!=m?m:(null!=z?z:1)/(null!=L?L:1),B={height:"100%",left:"0",top:"0",width:"100%"},Z=_&&v?(null!=v?v:g)/(null!=(d=Number(T))?d:y):g/y;if(!_&&Math.abs(Z-V)>.01){if(Z<V){var H=100*V/Z;B.width="".concat(H,"%"),B.left="-".concat((H-100)/2,"%")}else if(Z>V){var G=100*Z/V;B.height="".concat(G,"%"),B.top="-".concat((G-100)/2,"%")}}var N="number"==typeof h&&j<=h+3;return(0,f.jsx)(i.xu,{height:"100%",overflow:"hidden",position:"relative",width:"100%",children:(0,f.jsx)(i.xu,{height:"100%",position:"absolute",width:"100%",children:N||P||I?(0,f.jsx)(i.xu,{dangerouslySetInlineStyle:{__style:B},position:"absolute",children:(0,f.jsx)(l.Z,{aspectRatio:_?Z:m,autoplay:P,closeupStoryPinViewability:b,contextLogData:{component:0===j?227:228,element:10957,objectId:C,story_pin_page_id:j,view:3,viewParameter:157},customEndCard:x,customThumbnail:F,isPromoted:!1,loop:!1,muted:S,objectFit:M?_?"contain":"cover":void 0,onEnded:function(){w&&w(j)},onTimeChange:function(e){var t=e.time;O&&"number"==typeof D.duration&&D.duration>0&&O({currentTime:t,duration:D.duration/1e3})},pinId:C,pinKey:null===E?null:{type:"Legacy",data:E},preferMp4:!!M,showControls:"hover",variant:"storyPin",video:{id:A.id,hlsv3:R,mp4:M},videoThumbnailStartTime:I})}):F&&(0,f.jsx)(i.Ee,{alt:this.props.i18n._('Video cover image', 'closeup.storyPin.videoCover', 'cover image displayed for a video'),fit:"cover",naturalHeight:null!=L?L:1,naturalWidth:null!=z?z:1,src:F})})})}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,P(r.key),r)}}(o.prototype,n),Object.defineProperty(o,"prototype",{writable:!1}),o}(r.PureComponent);function w(e){var t=(0,s.u)().logContextEvent,n=e.pin,r=(0,u.Z)(),i=(0,p.x4)().closeupWithinMasonryEnabled,l=(0,d.K)().closeupBodyWidth,c=(0,o.Re)().maxHeight,h=(0,a.Z)({pinKey:null===n?null:{type:"Legacy",data:n}}).maxHeight;return(0,f.jsx)(S,y(y({},e),{},{closeupBodyWidth:l,closeupWithinMasonryEnabled:i,i18n:r,logContextEvent:t,maxHeight:i?h:c}))}},161458:function(e,t,n){n.d(t,{Z:function(){return ec}}),n(115821);var r,i,o=n(20256),a=n(800691),l=n(788730),s=n(653551),u=n(354553),c=n(230201),d=n(661376),p=n(680811),f=function(e){var t=e.block,n=t.block_style,r=(n=void 0===n?{}:n).height,i=n.width,a=n.x_coord,f=n.y_coord,h=n.rotation,m=t.original_comment_id,y=e.horizontalOffset,g=e.pageAspectRatio,v=e.scaleFactor,b=e.verticalOffset,_=(0,c.u)().logContextEvent,x=l._B/g,P=(void 0===i?0:i)*l._B*v/100,S=(void 0===r?0:r)*x*v/100,w=(void 0===a?0:a)*l._B*v/100+(void 0===y?0:y),O=(void 0===f?0:f)*x*v/100+(void 0===b?0:b),j=(0,s.s0)(),E=(0,d.Z)({name:"AggregatedCommentResource",options:{commentId:m,field_set_key:"comment_reply_sticker"}}).data;return(0,p.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{left:w,top:O,transform:"rotate(".concat(void 0===h?0:h,"deg)")}},display:"flex",height:S,margin:-1,padding:1,position:"absolute",rounding:2,width:P,zIndex:u.B_,children:(0,p.jsx)(o.iP,{onTap:function(){_({event_type:102,view_type:1,component:227,element:12541,aux_data:{comment_id:m}}),null!=E&&E.pin_id&&j("/pin/".concat(E.pin_id,"/comments/").concat(m||""))},rounding:"pill"})})},h=n(835531),m=n(631796);function y(e){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var g=["src","fallbackSrc"];function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach(function(t){var r,i;r=t,i=n[t],(r=function(e){var t=function(e,t){if("object"!=y(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=y(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==y(t)?t:t+""}(r))in e?Object.defineProperty(e,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[r]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function _(e){var t=e.src,n=e.fallbackSrc,r=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if(({}).hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&({}).propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(e,g),i=(0,m.Z)(t);return(0,p.jsx)(h.Z,b(b({},r),{},{src:i?t:n}))}var x=n(581722);function P(e){var t=e.isUseCache,n=e.signature;return(0,x.v9)(function(e){var r=e.pinbuilder.storyPinItemBlocks;if(!t)return null;for(var i=0,o=Object.keys(r);i<o.length;i++){var a,l,s=o[i];if((null==(a=r[s].media)?void 0:a.signatureEdited)===n||(null==(l=r[s].media)?void 0:l.signature)===n)return r[s]}return null})}var S=n(387784),w=n(331128),O=n(611649),j=n(465784),E=n(24246),C=n(107889);function T(e,t,n,r,i,o,a){try{var l=e[o](a),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(r,i)}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var I=function(e){var t,n=e.aggregatedCommentId,r=e.onDismiss,i=(0,E.Z)(),a=(0,O.Z)(),l=(0,w.Z)(),s=function(e){if(Array.isArray(e))return e}(t=(0,S.useState)(""))||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,l=[],s=!0,u=!1;try{for(o=(n=n.call(e)).next;!(s=(r=o.call(n)).done)&&(l.push(r.value),2!==l.length);s=!0);}catch(e){u=!0,i=e}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return l}}(t,2)||function(e,t){if(e){if("string"==typeof e)return A(e,2);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?A(e,2):void 0}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),u=s[0],c=s[1],d=(0,p.jsx)(o.kC,{justifyContent:"end",children:(0,p.jsx)(o.zx,{color:"red",disabled:!u,onClick:function(){var e;(e=regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l({fromUnifiedComment:!0,objectType:C.o.aggregatedComment,objectId:n,tags:"[]",text:u});case 2:case"end":return e.stop()}},e)}),function(){var t=this,n=arguments;return new Promise(function(r,i){var o=e.apply(t,n);function a(e){T(o,r,i,a,l,"next",e)}function l(e){T(o,r,i,a,l,"throw",e)}a(void 0)})})(),r()},text:i._('Post', 'ideapin.questionsticker.replymodal.postbutton', 'Post reply to creator Q&A question')})});return(0,p.jsx)(j.ZP,{accessibilityModalLabel:"reply to creator Q and A question",align:"start",footer:d,heading:i._('Reply', 'ideapin.questionsticker.replymodal', 'Reply to creator Q&A question'),onDismiss:r,children:(0,p.jsx)(o.xu,{paddingX:8,paddingY:1,children:(0,p.jsx)(o.Kx,{id:"ideaPinQuestionStickerReplyModalTextArea",onChange:function(e){c(e.value)},placeholder:a?i._('Your reply will show up as a public comment on this Pin.', 'pin.questionsticker.replymodal.placeholder', 'Placeholder for creator Q&A reply textarea'):i._('Your reply will show up as a public comment on this Idea Pin.', 'ideapin.questionsticker.replymodal.placeholder', 'Placeholder for creator Q&A reply textarea'),value:u})})})},k=n(583875),R=n(935059),M=n(183e3),D=n(216975),L=n(176783),F=n(847195);function z(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,l=[],s=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=o.call(n)).done)&&(l.push(r.value),l.length!==t);s=!0);}catch(e){u=!0,i=e}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return V(e,t);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?V(e,t):void 0}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function V(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var B=(void 0!==r||(r=n(511849)).hash&&"7e8d917850c8329247291df0d281a59b"!==r.hash&&console.error("The definition of 'StoryPinStickerBlockCloseup_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),r);function Z(e){var t,n=e.block,r=e.elementType,i=e.horizontalOffset,a=e.onFlyoutOpen,f=e.pageAspectRatio,h=e.pageIndex,m=e.pinKey,y=e.scaleFactor,g=e.tooltipElementType,v=e.verticalOffset,b=e.videoPinProgress,_=(0,c.u)().logContextEvent,x=z((0,S.useState)(!1),2),P=x[0],w=x[1],O=z((0,S.useState)(!1),2),j=O[0],C=O[1],T=(0,S.useRef)(null),A=(0,s.s0)(),V=(0,E.Z)(),Z=(0,M.Z)(B,m),H=(0,R.Z)(),G=n.block_style,N=(G=void 0===G?{}:G).height,W=G.width,U=G.x_coord,K=G.y_coord,X=G.rotation,q=n.end_time,$=n.error_message,J=n.interactive_sticker_type,Y=void 0===J?null:J,Q=n.is_removed,ee=n.is_valid,et=n.start_time,en=n.sticker_data,er=n.type,ei=null==Z?void 0:Z.entityId,eo=en||{},ea=eo.board_id,el=eo.question_comment_id,es=null!=(t=n.user)?t:{},eu=es.image_small_url,ec=es.full_name,ed=es.username,ep=null,ef=ee&&5===Y&&!!ea,eh=ee&&7===Y&&!!el,em=(0,d.Z)(ea&&ef?{name:"BoardResource",options:{field_set_key:"tagged_board_preview",board_id:ea}}:null),ey=em.data||{},eg=ey.is_collaborative,ev=ey.pin_count,eb=ey.url;er===L.h8.PRODUCT_STICKER?ep=ei?"/pin/".concat(ei,"/"):"/":er===L.h8.MENTION_STICKER?ep="/".concat(void 0===ed?"":ed,"/"):ef&&(ep=em.isLoaded?"".concat(eb):null);var e_=l._B/f,ex=(void 0===W?0:W)*l._B*y/100,eP=(void 0===N?0:N)*e_*y/100,eS=(void 0===U?0:U)*l._B*y/100+(void 0===i?0:i),ew=(void 0===K?0:K)*e_*y/100+(void 0===v?0:v),eO=(b||{}).currentTime,ej=!(0,F.Z)({currentTime:eO,endTime:q,startTime:et}),eE=function(){_({event_type:123,component:228,element:g,view_type:3,view_parameter:157,aux_data:{story_pin_page_id:h}}),w(!1)},eC=function(e){var t=e.event;_({event_type:120,component:228,element:g,view_type:3,view_parameter:157,aux_data:{error_message:!ee&&$?$:null,story_pin_page_id:h}}),w(!0),a&&(t.stopPropagation(),a())};(0,S.useEffect)(function(){return document.addEventListener("scroll",function(){w(!1)}),function(){return document.removeEventListener("scroll",function(){w(!1)})}},[]);var eT=function(){var e=null,t=H.isAuth?null==H?void 0:H.avatar_color_index:void 0;switch(er){case L.h8.PRODUCT_STICKER:var n=Z||{},r=n.gridTitle,i=n.imageSpec_236x,a=n.richSummary,l=n.description,s=a||{},u=s.displayName,c=((s.products||[])[0]||{}).offerSummary||{},d=c||{},f=d.price,h=d.maxPrice,m=!!c&&(!!f||!!h),y=u||r||l;e=(0,p.jsxs)(S.Fragment,{children:[(0,p.jsx)(o.xu,{flex:"none",children:(0,p.jsx)(o.zd,{height:40,rounding:3,wash:!0,width:40,children:(null==i?void 0:i.url)&&(0,p.jsx)(o.Ee,{alt:"",color:"lightGray",fit:"cover",naturalHeight:1,naturalWidth:1,src:i.url})})}),(0,p.jsx)(o.xu,{flex:"grow",paddingX:2,children:m?(0,p.jsxs)(o.kC,{alignContent:"center",alignItems:"stretch",direction:"column",flex:"grow",justifyContent:"center",children:[(0,p.jsx)(o.xv,{color:"default",lineClamp:1,size:"100",weight:"bold",children:f}),(0,p.jsx)(o.xv,{lineClamp:1,size:"100",children:y})]}):(0,p.jsx)(o.xv,{lineClamp:1,size:"100",children:y})}),(0,p.jsx)(o.xu,{flex:"none",children:(0,p.jsx)(o.Sj,{bgColor:"transparent",icon:"arrow-forward",iconColor:"darkGray",size:"xs"})})]});break;case L.h8.MENTION_STICKER:e=(0,p.jsxs)(S.Fragment,{children:[(0,p.jsx)(o.xu,{flex:"none",children:(0,p.jsx)(k.qE,{color:t,name:null!=ec?ec:"",size:"sm",src:null!=eu?eu:void 0})}),(0,p.jsx)(o.xu,{flex:"grow",paddingX:2,children:(0,p.jsx)(o.xv,{lineClamp:1,size:"200",weight:"bold",children:ec})}),(0,p.jsx)(o.xu,{flex:"none",children:(0,p.jsx)(o.Sj,{bgColor:"transparent",icon:"arrow-forward",iconColor:"darkGray",size:"xs"})})]});break;case L.h8.GENERIC_STICKER:e=[5].includes(Y)?ee?em.isLoaded?(0,p.jsxs)(S.Fragment,{children:[(0,p.jsxs)(o.xu,{flex:"grow",paddingX:2,children:[(0,p.jsx)(o.xv,{lineClamp:1,size:"100",weight:"bold",children:eg?V._('Explore this group board', 'closeup.StoryPin.stickerBlock.boardSticker.clickLabel', 'Label explaining click action when group board tag flyout showing'):V._('Explore this board', 'closeup.StoryPin.stickerBlock.boardSticker.clickLabel', 'Label explaining click action when board tag flyout showing')}),(0,p.jsx)(o.xv,{size:"100",children:(!!ev||0===ev)&&(0,D.nk)(V.ngettext('{{ pinCount }} Pin', '{{ pinCount }} Pins', ev, 'closeup.StoryPin.stickerBlock.boardSticker.boardLabel', 'Caption when board tag flyout that showing number of Pins on board'),{pinCount:ev})})]}),(0,p.jsx)(o.xu,{flex:"none",children:(0,p.jsx)(o.Sj,{bgColor:"transparent",icon:"arrow-forward",iconColor:"darkGray",size:"xs"})})]}):(0,p.jsxs)(o.xu,{alignItems:"center",direction:"row",display:"flex",flex:"grow",paddingY:2,children:[(0,p.jsx)(o.xu,{marginEnd:1,paddingX:2,children:(0,p.jsx)(o.xv,{color:"subtle",lineClamp:1,size:"100",children:V._('Loading board...', 'closeup.StoryPin.stickerBlock.boardSticker.loadingText', 'Label explaining board sticker still loading')})}),(0,p.jsx)(o.xH,{accessibilityLabel:V._('Board is loading', 'closeup.StoryPin.stickerBlock.boardSticker.loadingSpinnerText', 'Accessibility label for board loading spinner'),show:!0,size:"sm"})]}):(0,p.jsx)(o.xu,{paddingX:2,paddingY:2,children:(0,p.jsx)(o.xv,{color:"subtle",lineClamp:1,size:"200",weight:"bold",children:$})}):(0,p.jsx)(o.xu,{paddingX:2,paddingY:2,children:(0,p.jsx)(o.xv,{color:"subtle",lineClamp:1,size:"200",weight:"bold",children:V._('Sticker not supported yet', 'closeup.StoryPin.stickerBlock.genericStickerError', 'Label explaining this sticker has not been implemented yet')})});break;case L.h8.VTO_MAKEUP_STICKER:e=(0,p.jsx)(o.xv,{size:"300",weight:"bold",children:V._('Try this sticker on your phone!', 'closeup.storyPin.vtoMakeupSticker', 'Caption when @vitural-try-on-makeup tag is tapped for Web')})}return(0,p.jsx)(o.xu,{alignItems:"center","data-test-id":er,display:"flex",justifyContent:"center",padding:er===L.h8.PRODUCT_STICKER?1:3,width:"100%",children:Q?(0,p.jsx)(o.xv,{color:"subtle",size:"200",weight:"bold",children:V._('Tag removed!', 'closeup.storyPin.stickerBlock', 'Caption when the tag is removed')}):e})};return(0,p.jsx)(S.Fragment,{children:ej?null:(0,p.jsxs)(o.xu,{ref:T,dangerouslySetInlineStyle:{__style:{left:eS,top:ew,transform:"rotate(".concat(void 0===X?0:X,"deg)")}},"data-test-id":(er||"")+"_container",display:"flex",height:eP+2*l.Xw,margin:-1,padding:1,position:"absolute",rounding:2,width:ex+2*l.Xw,zIndex:u.B_,children:[(0,p.jsx)(o.iP,{disabled:ej,onTap:P?eE:function(e){var t=e.event;ej||(_({event_type:101,component:228,element:r,view_type:3,view_parameter:157,aux_data:{story_pin_page_id:h}}),eh?C(!0):eC({event:t}))},rounding:"pill"}),P&&(0,p.jsx)(o.mh,{zIndex:u.ej,children:(0,p.jsx)(o.J2,{_deprecatedShowCaret:!0,anchor:T.current,idealDirection:"up",onDismiss:eE,positionRelativeToAnchor:!1,size:Q?"flexible":"sm",children:Q?eT():(0,p.jsx)(o.iP,{fullWidth:!0,onTap:function(e){e.event.preventDefault(),Q||(_({event_type:101,component:228,element:g,object_id_str:ei,view_type:3,view_parameter:157,aux_data:{story_pin_page_id:h}}),ep?A(ep):eE())},children:eT()})})}),!!el&&j&&(0,p.jsx)(I,{aggregatedCommentId:el,onDismiss:function(){C(!1)}})]})})}var H=n(450228),G=n(542392),N=n(279394),W=n(590940);function U(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,l=[],s=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=o.call(n)).done)&&(l.push(r.value),l.length!==t);s=!0);}catch(e){u=!0,i=e}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return K(e,t);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?K(e,t):void 0}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function K(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function X(e){var t=e.block,n=e.fontsLoaded,r=e.horizontalOffset,i=e.pageAspectRatio,a=e.scaleFactor,l=e.thumbnail,s=e.verticalOffset,u=t.block_style,c=t.style,d=void 0===c?L.Cc:c,f=t.text,h=d.alignment,m=d.font,y=d.font_size,g=d.highlight_color,v=d.vertical_alignment,b=void 0===v?L.Cc.vertical_alignment:v,_=(null!=d?d:{}).hex_color,x=void 0===_?L.Cc.hex_color:_,P=U((0,S.useState)(0),2),w=P[0],O=P[1],j=U((0,S.useState)([]),2),E=j[0],C=j[1],T=m||L.Cc.font,A=T.name,I=T.default_size,k=T.letter_spacing,R=T.line_height,M=(0,W.Z)(T),D=Math.round(100*((null==u?void 0:u.width)||100))/1e4,F=Math.round(100*((null==u?void 0:u.height)||100))/1e4,z=Math.round(100*((null==u?void 0:u.x_coord)||0))/1e4,V=Math.round(100*((null==u?void 0:u.y_coord)||0))/1e4;(0,S.useEffect)(function(){if(n){var e=(0,N.KV)({text:f,boxHeight:G.q8/i*F,boxWidth:G.q8*D,font:M,startFontSize:Math.floor(y||I||24)});C(e.lines),O(e.fontSize)}},[n,f]);var B=w*a,Z=g?(0,L.pE)(B,R):{x:0,y:0},K=D*G.q8*a+2*Z.x,X=F*(G.q8/i)*a+2*Z.y,q=(void 0===r?0:r)+z*G.q8*a-Z.x,$=l?"".concat(100*V,"%"):(void 0===s?0:s)+V*(G.q8/i)*a-Z.y;return(0,p.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{left:q,top:$}},display:"flex",height:X,position:"absolute",width:K,children:(0,p.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:(0,H.RK)({alignment:h,verticalAlignment:b})},children:(0,p.jsx)(o.xu,{display:"inlineBlock",maxWidth:"100%",children:(0,p.jsx)("p",{style:(0,H.BN)({fontSize:B,hexColor:x,letterSpacing:k,lineHeight:R,name:A}),children:E.map(function(e,t){return(0,p.jsx)("span",{"data-gestalt-valid-html":"Text",style:(0,H.xm)({fontSize:B,hasText:e.text.length>0,highlightColor:g||null,lineHeight:R}),children:t===E.length-1?e.text:(0,p.jsxs)(S.Fragment,{children:[e.text," ",(0,p.jsx)("br",{})]})},"paragraphLine-".concat(t,"-").concat((null!=f?f:"").substr(0,9)))})})})})})}var q=n(690070);function $(e){var t=e.ownerId,n=(0,E.Z)(),r=(0,R.Z)(),i=r.isAuth&&r.id===t;return(0,p.jsxs)(o.xu,{alignItems:"center",color:"tertiary",direction:"column",display:"flex",height:"100%",justifyContent:"center",width:"100%",children:[(0,p.jsx)(o.xv,{color:"inverse",children:i?n._('Your video is processing!', 'closeup.storyPin.videoPlaceholder', 'Let user know that their video is still processing'):n._('This video is still processing!', 'closeup.storyPin.videoPlaceholder', 'Let user know that this video is still processing')}),(0,p.jsx)(o.xv,{color:"inverse",children:n._('Check back in a few minutes.', 'closeup.storyPin.videoPlaceholder', 'Let user know to come back in a couple of minutes to view the video')})]})}var J=n(928585),Y=n(689157),Q=n(852796),ee=n(23641),et=n(398542),en=n(113759),er=n(884541);function ei(e){return(ei="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function eo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ea(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?eo(Object(n),!0).forEach(function(t){var r,i;r=t,i=n[t],(r=function(e){var t=function(e,t){if("object"!=ei(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=ei(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ei(t)?t:t+""}(r))in e?Object.defineProperty(e,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[r]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eo(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function el(e){var t,n,r,i,s,u,c,d,f,m,y,g=e.block,v=e.isActive,b=e.pwtTrackImageLoad,x=e.thumbnail,S=(0,E.Z)(),w=(0,en.x4)(),O=w.closeupWithinMasonryEnabled,j=w.isCloseupMediaViewerOpen,C=w.peekCloseupEnabled,T=w.showProductDetailPage,A=(0,Y.Z)({showProductDetailPage:T}),I=(x||A?{}:(0,et.Z)({closeupWithinMasonryEnabled:O})).borderStyle,k=(null==(t=g.image)||null==(n=t.images)?void 0:n["750x"])||(null==(r=g.image)||null==(i=r.images)?void 0:i["474x"]),R=k||{},M=R.height,D=void 0===M?1:M,L=R.width,F=void 0===L?1:L,z=P({isUseCache:!0,signature:g.image_signature}),V=(0,J.Z)(k).peekRedesignFastFollowsEnabled;return k||z?(y=x?"cover":O||V?"none":"contain",(0,p.jsx)(o.xu,{alignItems:C?"center":void 0,dangerouslySetInlineStyle:{__style:ea(ea({},I),{},{aspectRatio:O?(0,a.GJ)(F,D):void 0,contain:"strict",display:C?"grid":"block",justifySelf:O?"center":void 0})},height:O?"100%":"inherit",overflow:"hidden",width:O?void 0:"inherit",children:z?(0,p.jsx)(_,{_enableViewTransitions:!0,alt:S._('Story pin image', 'closeup.storypin.renderer', 'Alt text for story pin image'),color:l.yc,elementTiming:"StoryPinImageBlock-MainPinImage",fallbackSrc:null!=(s=null==(u=z.media)?void 0:u.src)?s:"",fit:y,isActive:v,naturalHeight:D,naturalWidth:F,onLoad:b,src:null!=(c=null==k?void 0:k.url)?c:"",suppressViewTransitionTags:j}):(0,p.jsx)(h.Z,{_enableViewTransitions:!0,alt:S._('Story pin image', 'closeup.storypin.renderer', 'Alt text for story pin image'),borderStyle:I,color:l.yc,elementTiming:"StoryPinImageBlock-MainPinImage",fetchPriority:O?"high":void 0,fit:y,isActive:v,naturalHeight:null!=(d=null==k?void 0:k.height)?d:1,naturalWidth:null!=(f=null==k?void 0:k.width)?f:1,onLoad:b,src:null!=(m=null==k?void 0:k.url)?m:"",suppressViewTransitionTags:j})})):null}function es(e){var t,n,r=e.activePageIndex,i=e.block,a=e.closeupStoryPinViewability,s=e.customEndCard,u=e.isActive,c=e.isSplitLayout,d=e.musicRecordingId,f=e.muted,h=e.onEnded,m=e.onUpdateVideoInfo,y=e.ownerId,g=e.pageAspectRatio,v=e.pageDimensions,b=e.pageIndex,_=e.pin,x=e.pinId,S=e.scaleFactor,w=e.stillLoading,O=e.videoThumbnailStartTime,j=e.thumbnail,E=void 0!==j&&j,C=i.block_style,T=(C=void 0===C?{}:C).height,A=void 0===T?100:T,I=C.width,k=void 0===I?100:I,R=C.x_coord,M=void 0===R?0:R,D=C.y_coord,L=void 0===D?0:D,F=i.video,z=(0,en.x4)().closeupWithinMasonryEnabled,V=l._B/g,B=v.height,Z=v.width,H=k*l._B*S/100,G=k<100?Math.min(Math.max(100,k)-Math.abs(M),k):Math.min(Math.max(k-Math.abs(M),0),100),N=A<100?Math.min(Math.max(100,A)-Math.abs(L),A):Math.min(Math.max(A-Math.abs(L),0),100),W=z?"100%":N*V*S/100,U=z?"100%":G*l._B*S/100,K=Math.max(L,0)*V*S/100,X=Math.max(M,0)*l._B*S/100,J=P({isUseCache:!F,signature:i.video_signature});if(w)return null;var Y=(J||{}).media||{},Q=Y.duration,ee=Y.src,et=!!ee&&!!Q;return F||et?!!((null==F||null==(t=F.video_list)?void 0:t.V_HLSV3_MOBILE)||(null==F||null==(n=F.video_list)?void 0:n.V_720P)||et)&&(0,p.jsx)(o.xu,{height:void 0!==c&&c?"50%":"100%",overflow:"hidden",position:"relative",children:(0,p.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{alignSelf:"anchor-center",left:X,top:K}},"data-test-id":"story-pin-video-block",height:E?B:W,overflow:"hidden",position:"absolute",width:E?Z:U,children:(0,p.jsx)(q.Z,{activePageIndex:r,aspectRatio:g,blockHeight:E?B:A*V*S/100,blockWidth:E?Z:H,closeupStoryPinViewability:a,customEndCard:s,isPlaying:u,musicRecordingId:d,muted:f,onEnded:h,onUpdateVideoInfo:m,pageIndex:b,pin:_,pinId:x,video:F||{video_list:{V_EXP7:{duration:Q?1e3*Q:0,url:ee}}},videoThumbnailStartTime:O})})}):(0,p.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{left:X,top:K}},height:W,position:"absolute",width:U,children:(0,p.jsx)($,{ownerId:y})})}var eu=(void 0!==i||(i=n(77947)).hash&&"8bb1bb1f7bafeed0fe43bed44ef12d2a"!==i.hash&&console.error("The definition of 'StoryPinBlock_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),i);function ec(e){var t,n=e.activePageIndex,r=e.block,i=e.closeupStoryPinViewability,a=e.customEndCard,s=e.disableProductStickers,u=e.fontsLoaded,c=e.horizontalOffset,d=e.isActive,h=e.isSplitLayout,m=e.musicRecordingId,y=e.muteVideos,g=e.onEnded,v=e.onFlyoutOpen,b=e.onUpdateVideoInfo,_=e.ownerId,x=e.pageAspectRatio,P=e.pageHeight,S=e.pageIndex,w=e.pageWidth,O=e.pin,j=e.pinId,E=e.previewOnly,C=e.pinKey,T=e.stillLoading,A=e.thumbnail,I=void 0!==A&&A,k=e.transform,R=e.verticalOffset,D=e.videoPinProgress,F=e.videoThumbnailStartTime,z=(0,M.Z)(eu,C),V=(0,en.x4)().closeupWithinMasonryEnabled,B=r.block_style,H=(B=void 0===B?{}:B).height,G=void 0===H?100:H,N=B.width,W=void 0===N?100:N,U=B.x_coord,K=B.y_coord,q=r.interactive_sticker_type,$=(0,Q.g)();if(0===G||0===W)return null;var J=w/l._B;switch(r.type){case L.h8.PARAGRAPH:case L.h8.HEADING:return(0,p.jsx)(X,{block:r,fontsLoaded:u,horizontalOffset:c,pageAspectRatio:x,scaleFactor:J,thumbnail:I,verticalOffset:R});case L.h8.VIDEO:return(0,p.jsx)(es,{activePageIndex:n,block:r,closeupStoryPinViewability:i,customEndCard:a,isActive:d,isSplitLayout:void 0!==h&&h,musicRecordingId:m,muted:y,onEnded:g,onUpdateVideoInfo:b,ownerId:_,pageAspectRatio:x,pageDimensions:{height:P,width:w},pageIndex:S,pin:O,pinId:j,scaleFactor:J,stillLoading:void 0!==T&&T,thumbnail:I,videoThumbnailStartTime:F});case L.h8.IMAGE:var Y=k||{},et=Y.scaleX,ei=Y.scaleY;return(0,p.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{display:V?"grid":"block",height:"".concat(G,"%"),left:"".concat((void 0===U?0:U)*(void 0===et?1:et),"%"),top:"".concat((void 0===K?0:K)*(void 0===ei?1:ei),"%"),width:"".concat(W,"%")}},"data-test-id":"story-pin-image-block",overflow:"hidden",position:"absolute",children:(0,p.jsx)(el,{block:r,isActive:d,pwtTrackImageLoad:function(){$&&d&&($.addBinaryAnnotation("pin.id",j,"STRING"),$.addBinaryAnnotation("video",!1,"BOOL"),$.stop()),d&&((0,ee.rt)("pin.id",j,"STRING"),(0,ee.rt)("video",!1,"BOOL"),(0,ee.Nx)(er.pM),(0,ee.l7)(er._z))},thumbnail:I})});case L.h8.MENTION_STICKER:return!E&&(0,p.jsx)(Z,{block:ea({},r),elementType:12120,horizontalOffset:c,onFlyoutOpen:v,pageAspectRatio:x,pageIndex:S,pinKey:null,scaleFactor:J,tooltipElementType:12121,verticalOffset:R,videoPinProgress:D});case L.h8.GENERIC_STICKER:return!E&&(t=5===(void 0===q?null:q),(0,p.jsx)(Z,{block:ea({},r),elementType:t?12827:12858,horizontalOffset:c,onFlyoutOpen:v,pageAspectRatio:x,pageIndex:S,pinKey:null,scaleFactor:J,tooltipElementType:t?12828:12859,verticalOffset:R,videoPinProgress:D}));case L.h8.PRODUCT_STICKER:return!E&&!s&&(0,p.jsx)(Z,{block:ea({},r),elementType:12223,horizontalOffset:c,onFlyoutOpen:v,pageAspectRatio:x,pageIndex:S,pinKey:z,scaleFactor:J,tooltipElementType:12224,verticalOffset:R,videoPinProgress:D});case L.h8.VTO_MAKEUP_STICKER:return!E&&(0,p.jsx)(Z,{block:ea({},r),elementType:12561,horizontalOffset:c,onFlyoutOpen:v,pageAspectRatio:x,pageIndex:S,pinKey:null,scaleFactor:J,tooltipElementType:12561,verticalOffset:R,videoPinProgress:D});case L.h8.COMMENT_REPLY_STICKER:return r.type===L.h8.COMMENT_REPLY_STICKER&&!E&&(0,p.jsx)(f,{block:r,horizontalOffset:c,pageAspectRatio:x,scaleFactor:J,verticalOffset:R});default:return null}}},120034:function(e,t){t.Z=function(e){var t=e.carouselData,n=e.domain,r="",i=n||"";if(t){var o,a=t.carouselSlots,l=void 0===a?[]:a,s=null!=(o=t.index)?o:0;l&&l[s]&&(r=l[s].link||"",i=l[s].domain||i)}return{carouselLink:r,currentDomain:i}}},514793:function(e,t,n){n.d(t,{Z:function(){return f}});var r,i=n(387784);n(204306);var o=n(120034),a=n(689157),l=n(183e3),s=n(173922),u=n(605203),c=n(986523),d=n(113759),p=(void 0!==r||(r=n(82852)).hash&&"b2a27d44d1f3dbd42301b82866212272"!==r.hash&&console.error("The definition of 'useCalculateMaxWidthAndHeightForSideBySideVariant_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),r);function f(e){var t,n,r,f,h,m,y=e.pinKey,g=(0,d.x4)().closeupWithinMasonryEnabled,v=(0,c.Z)(),b=(0,l.Z)(p,y),_=(0,a.Z)({showProductDetailPage:!!(null!=b&&b.isEligibleForPdp)}),x=(0,s.Z)().group,P=(0,i.useMemo)(function(){var e;return null!=b&&b.carouselData?{carouselSlots:(null==(e=b.carouselData.carouselSlots)?void 0:e.map(function(e){return{domain:e.domain,link:e.link}}))||[],index:b.carouselData.index}:void 0},[null==b?void 0:b.carouselData]),S=(0,i.useMemo)(function(){return(0,o.Z)({carouselData:P,domain:null==b?void 0:b.domain})},[P,null==b?void 0:b.domain]).currentDomain,w=(0,i.useMemo)(function(){return S?S.split(".")[0]:""},[S]),O=(0,i.useMemo)(function(){var e=(null==b?void 0:b.trackedLink)||(null==b?void 0:b.link)||"",t=(0,u.Z)(e);return null!=t?t:e},[null==b?void 0:b.trackedLink,null==b?void 0:b.link]),j=(0,i.useMemo)(function(){var e,t,n,r,i,o,a,l=null==b||null==(e=b.richMetadata)||null==(t=e.products)?void 0:t[0],s=null==l?void 0:l.offerSummary,u=!!((null==s?void 0:s.price)||(null==s?void 0:s.standardPrice)),c=null==b||null==(n=b.linkDomain)||null==(r=n.officialUser)?void 0:r.firstName;return{hasPrice:u,domainOwner:!!(null==b||null==(i=b.closeupAttribution)?void 0:i.firstName)||!!c,merchantName:(null==b||null==(o=b.linkUserWebsite)||null==(a=o.officialUser)?void 0:a.firstName)||c||""}},[null==b||null==(t=b.richMetadata)?void 0:t.products,null==b||null==(n=b.linkDomain)||null==(r=n.officialUser)?void 0:r.firstName,null==b||null==(f=b.closeupAttribution)?void 0:f.firstName,null==b||null==(h=b.linkUserWebsite)||null==(m=h.officialUser)?void 0:m.firstName]),E=(0,i.useMemo)(function(){return!!((j.merchantName||w)&&O)},[j.merchantName,w,O]),C=(0,i.useMemo)(function(){var e,t=0,n=0;return e=84+(null!=b&&b.isEligibleForPdp&&j.hasPrice?18:0),t+=(null!=b&&b.closeupUnifiedTitle||null!=b&&b.gridTitle?23:0)+("enabled_idea_pin"!==x&&j.domainOwner?40:0),n+=64*!!E,e+=Math.max(t,n)},[null==b?void 0:b.isEligibleForPdp,j.hasPrice,null==b?void 0:b.closeupUnifiedTitle,null==b?void 0:b.gridTitle,x,j.domainOwner,E]);if(!g)return{maxHeight:void 0};if(v)return{maxHeight:_?void 0:"calc(round(100vh, 1px) - ".concat(80,"px - ").concat(C,"px)")};var T=Math.round(window.innerHeight)-80-C;return{maxHeight:_?void 0:T}}},928585:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(261978),i=n(501010),o=n(774838),a=n(739405);function l(e){var t=(0,o.B)().isAuthenticated,n=(0,a.HG)(),l=(0,i.Z)().checkExperiment,s=t&&n&&l("closeup_dweb_peek_redesign_fast_follow").anyEnabled,u=l("closeup_dweb_peek_redesign_fast_follow").group,c=t&&n&&l("closeup_dweb_side_by_side_redesign_fast_follow").anyEnabled,d=c?l("closeup_dweb_side_by_side_redesign_fast_follow").group:"";return{peekRedesignFastFollowsExpGroup:u,peekRedesignFastFollowsEnabled:s&&(0,r.Z)(u,e),sideBySideRedesignFastFollowsExpGroup:d,sideBySideRedesignFastFollowsEnabled:c,sideBySideFullWidthCTAEnabled:"enabled_full_width_cta"===d||"employees"===d,sideBySidePWTDeferActionBarLoad:"enabled_pwt_defer_action_bar_load"===d}}},689157:function(e,t,n){var r=n(501010),i=n(774838),o=n(739405);t.Z=function(e){var t=e.showProductDetailPage,n=e.skipActivation,a=(0,r.Z)().checkExperiment,l=(0,o.HG)();return!!(0,i.B)().isAuthenticated&&!!l&&!!t&&a("closeup_dweb_blended_ui",{dangerouslySkipActivation:n}).anyEnabled}},64897:function(e,t,n){n.r(t),n.d(t,{default:function(){return F}});var r=n(387784),i=n(793301),o=n(20256),a=n(768576),l=n(578377),s=n(4533),u=n(839603),c=n(24246),d=n(59111),p=n(34550),f=n(893957),h=n(986523),m=n(632492),y=n(680811);function g(e){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach(function(t){var r,i;r=t,i=n[t],(r=function(e){var t=function(e,t){if("object"!=g(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=g(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==g(t)?t:t+""}(r))in e?Object.defineProperty(e,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[r]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function _(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,l=[],s=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=o.call(n)).done)&&(l.push(r.value),l.length!==t);s=!0);}catch(e){u=!0,i=e}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return x(e,t);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?x(e,t):void 0}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function P(e){var t=e.containerRef,n=e.onAnimationEnd,i=e.startAnimating,a=e.containerWidth,l=(0,c.Z)(),f=(0,h.Z)(),g=(0,p.M0)(),v=_((0,r.useState)(),2),x=v[0],P=v[1],S=_((0,r.useState)(!1),2),w=S[0],O=S[1],j=_((0,r.useState)(),2),E=j[0],C=j[1],T=l._('Share', 'secondarySendButtonAnimation.share', 'Share label for sharing a Pin'),A={buttonStyle:{animation:x,backgroundColor:u.Et},textStyle:{animation:E}};return(0,r.useEffect)(function(){if(!f&&a)if(i){O(!0);var e=(g.getItem(s.$M)||{animationSeenCount:0}).animationSeenCount;g.setItem(s.$M,{animationSeenCount:e+1,lastAnimationTimestamp:Date.now()}),P("buttonSlideOut 1s ease-in forwards"),C("textFadeIn 1s ease-in forwards")}else P("buttonSlideIn .3s ease-in forwards"),C("textFadeOut .3s ease-in-out forwards")},[a,g,i,f]),(0,y.jsxs)(r.Fragment,{children:[(0,y.jsx)(d.Z,{unsafeCSS:"\n@keyframes buttonSlideOut {\n  0% {\n    width: ".concat(48,"px;\n  }\n  15% {\n    width: ").concat(a,"px;\n  }\n  100% {\n    width: ").concat(a,"px;\n  }\n}\n\n@keyframes textFadeIn {\n  0% {\n    opacity: 0;\n  }\n  15% {\n    opacity: 0;\n  }\n  25% {\n    opacity: 1;\n  }\n  100% {\n    opacity: 1;\n  }\n}\n\n@keyframes buttonSlideIn {\n  0% {\n    width: ").concat(a,"px;\n  }\n  100% {\n    width: ").concat(48,"px;\n  }\n}\n\n@keyframes textFadeOut {\n  0% {\n    opacity: 1;\n  }\n  15% {\n    opacity: 1;\n  }\n  25% {\n    opacity: 0;\n  }\n  100% {\n    opacity: 0;\n  }\n}\n")}),(0,y.jsx)(o.xu,{ref:t,alignItems:"center",dangerouslySetInlineStyle:{__style:b(b({},A.buttonStyle),{},{visibility:w?"visible":"hidden"})},display:"flex",onAnimationEnd:function(e){"buttonSlideIn"===e.animationName&&n()},position:"absolute",rounding:4,zIndex:m.mS,children:(0,y.jsxs)(o.kC,{alignItems:"center",gap:1,children:[(0,y.jsx)(o.xu,{padding:3,children:(0,y.jsx)(o.JO,{accessibilityLabel:T,color:"default",icon:"share",size:24})}),(0,y.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:A.textStyle},marginEnd:3,children:(0,y.jsx)(o.mg,{size:"300",children:T})})]})})]})}function S(e){var t=e.onAnimationEnd,n=(0,r.useRef)(null),i=_((0,r.useState)(0),2),o=i[0],a=i[1],s=_((0,r.useState)(!1),2),u=s[0],c=s[1];return(0,f.Z)(function(){var e=setTimeout(function(){c(!0);var e=setTimeout(function(){c(!1)},3e3);return function(){return clearTimeout(e)}},l.S+1e3);return function(){return clearTimeout(e)}}),(0,r.useEffect)(function(){if(n.current&&!o&&u){var e=n.current.getBoundingClientRect().width;e&&a(e)}},[n,o,u]),(0,y.jsx)(P,{containerRef:n,containerWidth:o,onAnimationEnd:t,startAnimating:u})}var w=n(15881),O=n(367683),j=n(501010),E=n(418282),C=n(957591),T=n(38181),A=n(500499);function I(e){return(I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach(function(t){M(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function M(e,t,n){var r;return(r=function(e,t){if("object"!=I(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=I(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==I(r)?r:r+"")in e)?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function D(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,l=[],s=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=o.call(n)).done)&&(l.push(r.value),l.length!==t);s=!0);}catch(e){u=!0,i=e}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return L(e,t);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?L(e,t):void 0}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function F(e){var t=e.controllerOptions,n=e.iconColor,l=e.iconOnly,u=e.buttonText,d=e.showSendAnimation,h=void 0!==d&&d,m=e.tabIndex,g=void 0===m?0:m,v=e.closeupWithinMasonryEnabled,b=void 0!==v&&v,_=e.isInCloseupMediaViewer,x=void 0!==_&&_,P=(0,c.Z)(),I=(0,r.useId)(),k=(0,p.M0)(),L=(0,E.Nl)(),F=(0,j.Z)().checkExperiment,z=(0,C.f)().setIsShowingShareButton,V=(0,r.useRef)(null),B=D((0,r.useState)(h),2),Z=B[0],H=B[1],G=x?new o.H3([T.k]):new o.Ry(5),N=D((0,r.useState)(function(){var e=L.getItem(w.bl)||0;return(k.getItem(s.$M)||{animationSeenCount:0}).animationSeenCount<2&&(2===e||3===e)}),1)[0],W=function(){H(!1)};(0,f.Z)(function(){var e=(k.getItem(s.$M)||{lastAnimationTimestamp:0}).lastAnimationTimestamp;(0,i.Z)(new Date(e),new Date)||k.setItem(s.$M,{animationSeenCount:0,lastAnimationTimestamp:e})}),(0,r.useEffect)(function(){return z(h),function(){z(!1)}},[z,h]);var U=(0,r.useMemo)(function(){return x&&l?"washLight":b?"white":void 0},[x,l,b]);return(0,y.jsxs)(r.Fragment,{children:[(0,y.jsx)(A.Z,R(R({popoverId:I},t),{},{children:function(e){var r=e.handleSendShareFlyoutButtonClick;return(0,y.jsxs)(o.u,{inline:!0,text:P._('Share', 'Closeup.SharePin.Icon', 'Icon for sharing the current pin'),zIndex:G,children:[Z&&N&&F("sg_dweb_improved_share_animation_on_closeup").anyEnabled&&(0,y.jsx)(o.xu,{"data-test-id":"closeup-share-button",children:(0,y.jsx)(o.iP,{onTap:r,children:(0,y.jsx)(S,{onAnimationEnd:W})})}),x&&!l?(0,y.jsx)(o.zx,{ref:V,accessibilityControls:t.isFlyoutOpen?I:void 0,accessibilityExpanded:t.isFlyoutOpen,accessibilityHaspopup:!0,accessibilityLabel:P._('Share', 'Closeup.SharePin.AccessibilityLabel', 'Accessible label for button to share this pin'),color:"tertiarySemiTransparent",iconEnd:"share",onClick:r,size:"lg",tabIndex:g,text:(0,y.jsx)(o.xv,{weight:"bold",children:P._('Share', 'Closeup.SharePin.Button', 'Button to share the current pin')})}):(0,y.jsx)(a.Z,{ref:V,accessibilityControls:t.isFlyoutOpen?I:void 0,accessibilityExpanded:t.isFlyoutOpen,accessibilityHaspopup:!0,accessibilityLabel:P._('Send', 'Accessible label for button to send this pin', 'Accessible label for button to send this pin'),bgColor:U,buttonText:u,handleClick:function(){return r()},icon:"share",iconColor:n,iconOnly:l,isActive:t.isFlyoutOpen,size:x&&l?"lg":void 0,tabIndex:g,testId:"closeup-share-button"})]})}})),(0,y.jsx)(O.N,{anchors:M({},3017,V.current),idealDirection:"down",onAnchorTouch:"complete",placementId:12,scrollToDismiss:!0})]})}},70806:function(e,t,n){n.d(t,{Z:function(){return ec}});var r,i,o=n(387784);n(204306);var a=n(20256),l=n(788730),s=n(514793),u=n(45350),c=n(64897),d=n(230201),p=n(943152),f=n(183e3),h=n(24246),m=n(113759),y=n(767415),g=n(680811);function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach(function(t){O(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function x(e,t){return(x=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function P(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function S(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(S=function(){return!!e})()}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function O(e,t,n){return(t=j(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function j(e){var t=function(e,t){if("object"!=v(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=v(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==v(t)?t:t+""}var E={__style:{backgroundColor:"#000"}},C=(void 0!==r||(r=n(297723)).hash&&"e04be51b4be0a2585e7803d004fa83b7"!==r.hash&&console.error("The definition of 'CloseupVideoEndCard_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),r),T=function(e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),e&&x(i,e);var t,n,r=(t=S(),function(){var e,n=w(i);return e=t?Reflect.construct(n,arguments,w(this).constructor):n.apply(this,arguments),function(e,t){if(t&&("object"==v(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return P(e)}(this,e)});function i(){var e;if(!(this instanceof i))throw TypeError("Cannot call a class as a function");for(var t=arguments.length,n=Array(t),o=0;o<t;o++)n[o]=arguments[o];return O(P(e=r.call.apply(r,[this].concat(n))),"handleRestartVideo",function(t){var n,r,i=t.event;i.stopPropagation(),null==(n=(r=e.props).onRestartVideo)||n.call(r,{event:i}),(0,y.nP)("web.video.endcard.share",{sampleRate:1,tags:{status:"restart",variant:"enabled_send_first"}})}),O(P(e),"handleShareVideo",function(){var t=e.props,n=t.clientTrackingParams,r=t.onToggleFlyout,i=t.isFlyoutOpen,o=t.pinId,a=t.requireAuth,l=t.logContextEvent;if(i&&(0,y.nP)("web.video.endcard.share",{sampleRate:1,tags:{status:"shareSheetOpen",variant:"enabled_send_first"}}),l({event_type:101,component:179,object_id_str:o,view_type:3,view_parameter:156,element:11731,clientTrackingParams:n}),a)return void a();r&&r()}),O(P(e),"handleExternalSend",function(){(0,y.nP)("web.video.endcard.share",{sampleRate:1,tags:{status:"shareSheetOpen",variant:"enabled_send_first"}})}),O(P(e),"renderReplayButton",function(){return(0,g.jsx)(a.iP,{accessibilityLabel:e.props.i18n._('Watch again', 'Button when pressed restarts the video', 'Button when pressed restarts the video'),onTap:e.handleRestartVideo,rounding:2,children:(0,g.jsxs)(a.xu,{alignItems:"center",display:"flex",padding:2,children:[(0,g.jsx)(a.xu,{marginEnd:3,children:(0,g.jsx)(a.JO,{accessibilityLabel:e.props.i18n._('Watch again', 'Button when pressed restarts the video', 'Button when pressed restarts the video'),color:"inverse",icon:"refresh",size:18})}),(0,g.jsx)(a.X6,{color:"light",overflow:"normal",size:"400",children:e.props.i18n._('Watch again', 'Clickable label when pressed restarts the video', 'Clickable label when pressed restarts the video')})]})})}),O(P(e),"renderShareButton",function(){var t=e.props,n=t.clientTrackingParams,r=t.gridDescription,i=t.imageSrc,o=t.isFlyoutOpen,l=t.onFlyoutDismiss,s=t.pinId;return(0,g.jsx)(a.iP,{accessibilityLabel:e.props.i18n._('Send', 'end.video.send.icon.label', 'Clickable label when pressed opens share sheet after video is finished'),onTap:e.handleShareVideo,rounding:2,children:(0,g.jsxs)(a.xu,{alignItems:"center",display:"flex",justifyContent:"center",padding:2,children:[(0,g.jsx)(c.default,{controllerOptions:{flyoutDisplayOptions:{shownWithinMasonry:!0},loggingOptions:{component:179,element:72,onExternalSend:e.handleExternalSend,viewType:3},isFlyoutOpen:o,onFlyoutDismiss:l,onToggleFlyout:function(){},sendObject:{type:"pin",description:r,id:s,imageUrl:i,url:"/pin/".concat(s,"/"),clientTrackingParams:n}},iconColor:"white",iconOnly:!0,tabIndex:-1}),(0,g.jsx)(a.xu,{children:(0,g.jsx)(a.X6,{color:"light",overflow:"normal",size:"400",children:e.props.i18n._('Send', 'end.video.send.icon.label', 'Clickable label when pressed opens share sheet after video is finished')})})]})})}),e}return n=[{key:"componentDidMount",value:function(){var e=this.props,t=e.clientTrackingParams,n=e.pinId,r=e.logContextEvent;(0,y.nP)("web.video.endcard.share",{sampleRate:1,tags:{status:"land",variant:"enabled_send_first"}}),r({event_type:13,component:179,object_id_str:n,view_type:3,view_parameter:156,element:11731,clientTrackingParams:t})}},{key:"render",value:function(){var e=this.props,t=e.backgroundImage,n=e.naturalHeight,r=e.naturalWidth,i=e.maxHeight,o=e.maxWidth,l=e.pinTitle;return(0,g.jsx)(a.xu,{maxHeight:i,maxWidth:o,children:(0,g.jsxs)(a.Ee,{alt:l||"",naturalHeight:n,naturalWidth:r,src:t,children:[(0,g.jsx)(a.xu,{bottom:!0,dangerouslySetInlineStyle:E,left:!0,position:"absolute",right:!0,top:!0}),(0,g.jsx)(a.xu,{alignItems:"center",direction:"column",display:"flex",height:"100%",justifyContent:"center",left:!0,maxHeight:i,maxWidth:o,position:"absolute",top:!0,width:"100%",children:(0,g.jsxs)(a.xu,{position:"absolute",children:[(0,g.jsx)(a.xu,{children:this.renderShareButton()}),(0,g.jsx)(a.xu,{alignSelf:"center",children:this.renderReplayButton()})]})})]})})}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,j(r.key),r)}}(i.prototype,n),Object.defineProperty(i,"prototype",{writable:!1}),i}(o.PureComponent);function A(e){var t,n=e.pinKey,r=e.variant,i=(0,f.Z)(C,n),o=(0,d.u)().logContextEvent,a=(0,h.Z)(),u=(0,p.Z)(),c=(0,m.x4)(),y=c.closeupWithinMasonryEnabled,v=c.peekCloseupEnabled,b=c.viewportSize,x=(0,l.Re)(),P=x.maxHeight,S=x.fiftyPercentHeight,w=x.fiftyPercentWidth,O=(0,s.Z)({pinKey:i}).maxHeight;return v?t="sm"===b?S:P:y&&(t=O),(0,g.jsx)(T,_(_({},e),{},{closeupWithinMasonryEnabled:y,i18n:a,logContextEvent:o,maxHeight:"media-viewer"===r?"inherit":t,maxWidth:"media-viewer"===r?"inherit":w,requireAuth:u}))}var I=function(e){var t=e.backgroundImage,n=e.onRestartVideo,r=e.pinTitle,i=(0,h.Z)();return(0,g.jsx)(a.xu,{"data-test-id":"video-end-card",height:"100%",width:"100%",children:(0,g.jsxs)(a.Ee,{alt:r||"",fit:"contain",naturalHeight:1,naturalWidth:1,src:t,children:[(0,g.jsx)(a.xu,{bottom:!0,dangerouslySetInlineStyle:E,left:!0,opacity:.8,position:"absolute",right:!0,top:!0}),(0,g.jsx)(a.xu,{alignItems:"center",display:"flex",height:"100%",justifyContent:"center",left:!0,position:"absolute",top:!0,width:"100%",children:(0,g.jsx)(a.xu,{children:(0,g.jsx)(a.iP,{onTap:n,rounding:2,children:(0,g.jsxs)(a.xu,{alignItems:"center",display:"flex",padding:2,children:[(0,g.jsx)(a.hU,{accessibilityLabel:i._('Replay', 'closeupVideo.endCard.ReplayButton', 'Button when pressed restarts the video'),icon:"refresh",iconColor:"white",size:"md"}),(0,g.jsx)(a.X6,{color:"light",overflow:"normal",size:"400",children:i._('Replay', 'closeupVideo.endCard.ReplayButton', 'Button when pressed restarts the video')})]})})})})]})})},k=n(343669),R=n(426035),M=n(852796),D=n(296264),L=n(417394),F=n(23641),z=n(774838),V=n(410706),B=n(151383),Z=n(176783),H=n(967515),G=n(629724),N=n(739405),W=n(764682),U=n(74972),K=n(884541),X=n(317083),q=n(959703);function $(e){return($="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function J(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,l=[],s=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=o.call(n)).done)&&(l.push(r.value),l.length!==t);s=!0);}catch(e){u=!0,i=e}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Y(e,t);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Y(e,t):void 0}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function Q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(n),!0).forEach(function(t){eo(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function et(e,t){return(et=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function en(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function er(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(er=function(){return!!e})()}function ei(e){return(ei=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function eo(e,t,n){return(t=ea(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ea(e){var t=function(e,t){if("object"!=$(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=$(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==$(t)?t:t+""}var el=(void 0!==i||(i=n(842246)).hash&&"53ae9ecd15f057f744460205e5d495fd"!==i.hash&&console.error("The definition of 'CloseupVideoNonDuplo_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),i),es=function(e,t){var n,r;t({currentTime:null!=(n=null==e?void 0:e.currentTime)?n:0,duration:null!=(r=null==e?void 0:e.duration)?r:1})},eu=function(e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),e&&et(i,e);var t,n,r=(t=er(),function(){var e,n=ei(i);return e=t?Reflect.construct(n,arguments,ei(this).constructor):n.apply(this,arguments),function(e,t){if(t&&("object"==$(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return en(e)}(this,e)});function i(){var e;if(!(this instanceof i))throw TypeError("Cannot call a class as a function");for(var t=arguments.length,n=Array(t),o=0;o<t;o++)n[o]=arguments[o];return eo(en(e=r.call.apply(r,[this].concat(n))),"state",{controls:"always"===e.props.showControls&&!e.props.disabled,fullscreen:!1,playing:!(0,k.G6)(e.props.requestContext.userAgent.browserName)&&!!e.props.autoplay&&!e.props.disabled,ready:!1,seeking:!1,showEndCard:!1,volume:e.props.muted||e.props.shouldMute?0:1,videoStartTime:e.props.videoStartTime||0}),eo(en(e),"setVideoPwtLoadingStop",function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(D.Z){var n=e.props,r=n.storyPinStepStopwatch,i=n.pinId;r&&(t||r.addAnnotation("video.startup.end"),r.addBinaryAnnotation("pin.id",i,"STRING"),r.addBinaryAnnotation("video",!0,"BOOL"),r.addBinaryAnnotation("preload",t,"BOOL"),r.addSubspan({name:"perceived_video_load",endTime:D.Z.now()}),r.stop()),t||(0,R.ZP)("video.startup.end"),(0,R.L8)("perceived_video_load"),(0,F.Nx)(K._z),(0,F.rt)("pin.id",i,"STRING"),(0,F.rt)("video",!0,"BOOL"),"STORY_PIN_CLOSEUP"===(0,L.Ly)()&&(0,F.l7)(K.pM)}}),eo(en(e),"componentDidMount",function(){var t=e.props,n=t.customThumbnail,r=t.video,i=t.preferMp4,o=r.mp4,a=r.hlsv3||r.hls||null,l=(i&&o||a||{}).thumbnail,s=(0,X.j4)(n||l);(null==s?void 0:s.ready)===4&&(e.setState({ready:!0}),e.props.autoplay&&e.setVideoPwtLoadingStop(!0)),document.addEventListener("fullscreenchange",e.onFullscreenChange),document.addEventListener("webkitfullscreenchange",e.onFullscreenChange),document.addEventListener("mozfullscreenchange",e.onFullscreenChange),document.addEventListener("MSFullscreenChange",e.onFullscreenChange)}),eo(en(e),"componentWillUnmount",function(){document.removeEventListener("fullscreenchange",e.onFullscreenChange),document.removeEventListener("webkitfullscreenchange",e.onFullscreenChange),document.removeEventListener("mozfullscreenchange",e.onFullscreenChange),document.removeEventListener("MSFullscreenChange",e.onFullscreenChange)}),eo(en(e),"onFullscreenChange",function(){document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||e.props.setPanelOpen(function(e){return!e})}),eo(en(e),"componentDidUpdate",function(t,n){e.props.videoStartTime&&e.props.videoStartTime!==t.videoStartTime&&e.setState({videoStartTime:e.props.videoStartTime}),!1===t.isPlaying&&e.props.isPlaying&&e.setState({playing:!0,controls:"never"!==e.props.showControls}),t.isPlaying&&!1===e.props.isPlaying&&e.setState({playing:!1}),t.autoplay!==e.props.autoplay&&(e.setState({playing:!!e.props.autoplay}),e.props.autoplay&&e.state.ready&&e.setVideoPwtLoadingStop(!0)),t.muted!==e.props.muted&&e.setState({volume:+!e.props.muted}),"never"===e.props.showControls&&n.controls&&e.setState({controls:!1}),(n.controls||n.playing)&&e.props.disabled&&e.setState({playing:!1,controls:!1}),!n.playing&&e.state.playing&&e.props.onPlay&&e.props.onPlay(),e.props.isCloseupMediaViewerOpen&&!t.isCloseupMediaViewerOpen&&e.setState({playing:!1})}),eo(en(e),"handleTouch",function(){var t=e.state.seeking,n=e.props.disabled;t||n||e.setState(function(e){return{playing:!e.playing}})}),eo(en(e),"handleShowControls",function(){return e.setState({controls:!0})}),eo(en(e),"handleHideControls",function(){return e.setState({controls:!1})}),eo(en(e),"handleReady",function(){var t=e.state,n=t.ready,r=t.playing,i=e.props,o=i.autoplay,a=i.disabled;o&&!n&&e.setVideoPwtLoadingStop(),e.setState({ready:!0}),(0,k.G6)(e.props.requestContext.userAgent.browserName)&&!r&&o&&!a&&e.setState({playing:!0})}),eo(en(e),"handleEnded",function(t){var n=t.event,r=e.props,i=r.customThumbnail,o=r.customEndCard,a=r.pinId,l=r.setCurrentVideo,s=r.loop,u=r.onEnded;n.stopPropagation(),!s&&(e.setState({playing:!1}),i&&i.endsWith(".gif")||o||(e.setState({showEndCard:!0,videoStartTime:0}),l({pinId:a,isPromoted:!1,currentTime:0})),e.state.fullscreen&&e.exitFullscreen()),u&&u(),e.props.setPanelOpen(!0)}),eo(en(e),"handlePause",function(t){t.event.stopPropagation(),e.setState({playing:!1})}),eo(en(e),"handlePlay",function(t){t.event.stopPropagation(),e.setState({playing:!0})}),eo(en(e),"handleFullscreenChange",function(t){var n=t.event,r=t.fullscreen;n.stopPropagation(),e.setState({fullscreen:r})}),eo(en(e),"handlePlayheadDown",function(){e.setState({seeking:!0})}),eo(en(e),"handlePlayheadUp",function(){setTimeout(function(){e.setState({seeking:!1})},500)}),eo(en(e),"handleRestartVideo",function(t){t.event.stopPropagation(),e.setState({playing:!0,showEndCard:!1})}),eo(en(e),"handleShareRestartVideo",function(t){t.event.stopPropagation(),e.setState({playing:!0,showEndCard:!1})}),eo(en(e),"handleVolumeChange",function(t){var n=t.event,r=t.volume,i=e.props.shouldMute;n.stopPropagation(),i||e.setState({volume:r})}),eo(en(e),"exitFullscreen",function(){var e=window.document;(e.fullscreenElement||e.webkitFullscreenElement||e.mozFullScreenElement)&&(e.exitFullscreen?e.exitFullscreen():e.webkitExitFullscreen?e.webkitExitFullscreen():e.mozCancelFullScreen?e.mozCancelFullScreen():e.msExitFullscreen&&e.msExitFullscreen())}),eo(en(e),"requestFullscreen",function(){var t=e.props,n=t.customThumbnail,r=t.video,i=t.preferMp4,o=r.mp4,a=r.hlsv3||r.hls||null,l=(i&&o||a||{}).thumbnail,s=(0,X.j4)(n||l);s.requestFullscreen?s.requestFullscreen():s.webkitRequestFullscreen?s.webkitRequestFullscreen():s.mozRequestFullScreen?s.mozRequestFullScreen():s.msRequestFullscreen&&s.msRequestFullscreen()}),eo(en(e),"renderCloseupVideoEndCard",function(t,n,r,i){var o={backgroundImage:t,naturalHeight:n,naturalWidth:r,onRestartVideo:e.handleShareRestartVideo},a={backgroundImage:t,naturalHeight:n,naturalWidth:r,onRestartVideo:e.handleRestartVideo},l=e.props,s=l.clientTrackingParams,u=l.flyoutShareProps,c={clientTrackingParams:s,gridDescription:u?u.gridDescription:"",imageSrc:u?u.imageSrc:"",isFlyoutOpen:!!u&&u.isFlyoutOpen,onFlyoutDismiss:u?u.onFlyoutDismiss:function(){},onToggleFlyout:u?u.onToggleFlyout:function(){},pinId:u?u.pinId:"",pinKey:e.props.pin,variant:e.props.variant};return i?(0,g.jsx)(I,ee({},a)):(0,g.jsx)(A,ee(ee({},c),o))}),e}return n=[{key:"render",value:function(){var e=this,t=this.props,n=t.aspectRatio,r=t.autoplay,i=t.closeupStoryPinViewability,o=t.contextLogData,s=void 0===o?{component:179,is_closeup_video:!0,objectId:this.props.pinId,view:3,viewParameter:156}:o,c=t.customThumbnail,d=t.isPromoted,p=t.loop,f=t.objectFit,h=t.preferMp4,m=t.preload,y=t.requestContext,v=t.showControls,b=t.variant,_=t.video,x=t.captions,P=t.isDesktop,S=t.videoThumbnailStartTime,w=t.pin,O=t.pinId,j=t.setProgressInfo,E=t.progressInfo,C=t.setPanelOpen,T=t.panelOpen,A=t.setMute,I=t.isMuted,R=t.closeupWithinMasonryEnabled,M=t.maxHeight,D=t.maxWidth,L=t.onTimeChange,F=t.seekTime,z=t.roundingOverride;s.is_closeup_video=!0;var H=this.state,G=H.controls,N=H.fullscreen,U=H.playing,K=H.showEndCard,$=H.volume,J=H.videoStartTime,Y=_.hlsv3||_.hls||null;if(!Y&&!_.mp4)return null;var Q=_.mp4,et=h&&Q&&Q.url||Y&&[{type:"video/m3u8",src:Y.url}]||void 0,en=h&&Q||Y||{},er=en.height,ei=en.thumbnail,eo=en.width,ea=c||ei;return(0,g.jsxs)(a.zd,{height:R||"media-viewer"===b?"inherit":void 0,rounding:z,wash:!R&&"media-viewer"!==b||void 0,width:R||"media-viewer"===b?"inherit":void 0,willChangeTransform:!((0,k.G6)(y.userAgent.browserName)&&N),children:[K?this.renderCloseupVideoEndCard(null!=ea?ea:"",null!=er?er:1,null!=eo?eo:1,d):(0,g.jsxs)(a.iP,{accessibilityLabel:this.props.i18n._('Pause or play video', 'pin.closeup.video.tap', 'tap area to pause or play video'),fullHeight:R||"media-viewer"===b,onMouseEnter:"hover"===v?this.handleShowControls:void 0,onMouseLeave:"hover"===v?this.handleHideControls:void 0,onTap:this.handleTouch,rounding:2,children:[(0,g.jsx)(V.Z,{playing:U,zIndexValue:99}),(0,g.jsx)(u.Z,{id:"VideoWithContextLogging",children:(0,g.jsx)(q.ZP,{aspectRatio:null!=n?n:(null!=eo?eo:1)/(null!=er?er:1),backgroundColor:R?"black":l.yc,captions:x,closeupStoryPinViewability:i,contextLogData:ee(ee({},s),{},{video_id:this.props.video.id}),hlsConfig:{startLevel:X.VS},isAutoPlay:!!r,loop:p,objectFit:f,onControlsPause:this.handlePause,onControlsPlay:this.handlePlay,onEnded:this.handleEnded,onFullscreenChange:this.handleFullscreenChange,onPlay:function(){},onPlayError:function(){},onPlayheadDown:this.handlePlayheadDown,onPlayheadUp:this.handlePlayheadUp,onReady:this.handleReady,onTimeChange:"storyPin"===b?L:function(e){var t=e.time;es&&"number"==typeof(null==Q?void 0:Q.duration)&&Q.duration>0&&j&&es({currentTime:t,duration:Q.duration/W.gJ},j)},onVolumeChange:this.handleVolumeChange,pin:w,pinKey:w,playing:U,poster:ea,preferMp4:h,preload:m,seekTime:F,src:et,variant:b,video:h&&Q||Y||{},videoStartTime:J||S,volume:$})})]}),(0,g.jsx)(a.xu,{onMouseEnter:"hover"===v?this.handleShowControls:void 0,onMouseLeave:"hover"===v?this.handleHideControls:void 0,children:"storyPin"!==b&&(0,g.jsx)(a.xu,{bottom:!0,dangerouslySetInlineStyle:{__style:ee(ee({},G?ee({},X.Ul):{}),{},{flexDirection:"column-reverse"})},display:"flex",height:X.hy,maxHeight:M,maxWidth:D,paddingX:6,position:"absolute",width:"100%",zIndex:Z.Gf,children:(0,g.jsx)(u.Z,{id:"IdeaPinVideoScrubber",children:(0,g.jsx)(B.Z,{activePageIndex:0,captionsUrl:x,handleMute:function(){e.setState({volume:+!!I}),A(!I)},handlePanelChange:function(){C&&C(!T),T&&P&&e.requestFullscreen()},handlePause:function(){e.setState({playing:!1})},handlePausePlay:function(){e.setState({playing:!U})},handlePlay:function(){e.setState({playing:!0})},handleWatchAgain:this.handleRestartVideo,inMilliseconds:!1,isMuted:I,isPanelOpen:T,isPlaying:U,isStoryPin:!1,pageCount:1,pages:[],pinId:O,progressInfo:E,showEndCard:K,showVideoControls:G,viewParameter:156})})})})]})}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ea(r.key),r)}}(i.prototype,n),Object.defineProperty(i,"prototype",{writable:!1}),i}(o.Component);function ec(e){var t,n,r,i=e.pinKey,a=e.pinId,c=e.isPromoted,d=e.video,p=e.muted,y=e.variant,v=(0,f.Z)(el,i),b=(0,h.Z)(),_=(0,z.B)(),x=(0,M.g)(),P=(0,H.Hx)().seekTimes,S=(0,m.x4)(),w=S.clientTrackingParams,O=S.closeupWithinMasonryEnabled,j=S.isCloseupMediaViewerOpen,E=(0,l.Re)().maxWidth,C=(0,U.G)(),T=C.appUI,A=C.setCurrentVideo,I=T.videosAutoplaying,k=I.organicVideosAutoplaying,R=I.promotedVideosAutoplaying,D=_.locale.toLowerCase(),L=null!=(t=(null==(n=d.mp4)?void 0:n.captions_urls)||(null==(r=d.hlsv3)?void 0:r.captions_urls))?t:{},F=D&&L[D]||Object.values(L)[0]||"",V=(0,N.HG)(),B=c?R[a]:k[a],Z=parseInt((0,G.Z)().t||0,10),W=J((0,o.useState)((null==B?void 0:B.currentTime)||0),2),K=W[0],X=W[1],q=J((0,o.useState)(null),2),$=q[0],Y=q[1],Q=J((0,o.useState)(!0),2),et=Q[0],en=Q[1],er=J((0,o.useState)(p),2),ei=er[0],eo=er[1],ea=(0,s.Z)({pinKey:v}).maxHeight;(0,o.useEffect)(function(){var e=K;Z>0&&(e=Z),P[a]&&(e=P[a]),X(e)},[P,a,Z,K]);var es=(0,o.useMemo)(function(){return("default"!==y||!j)&&(!B||!B.paused)},[y,B,j]);return(0,g.jsx)(u.Z,{id:"CloseupVideoInner",children:(0,g.jsx)(eu,ee(ee({},e),{},{captions:String(F)||"",clientTrackingParams:w,closeupWithinMasonryEnabled:O,i18n:b,isCloseupMediaViewerOpen:j,isDesktop:V,isMuted:ei,isPanelOpen:et,isPlaying:es,maxHeight:ea,maxWidth:"media-viewer"===y?void 0:E,panelOpen:et,pin:v,progressInfo:$,requestContext:_,seekTime:P[a],setCurrentVideo:A,setMute:eo,setPanelOpen:en,setProgressInfo:Y,storyPinStepStopwatch:x,variant:y,videoStartTime:K}))})}eo(eu,"defaultProps",{loop:!1,showControls:"hover"})},200301:function(e,t,n){n.d(t,{Z:function(){return r}});function r(e){var t;return e&&null!=(t=[e["736x"],e["564x"],e["474x"],e["236x"]].find(function(e){return null==e?void 0:e.url}))?t:null}},295472:function(e,t,n){n.d(t,{Z:function(){return a}});var r=n(951170),i=n.n(r),o=n(767415);function a(e){if("undefined"==typeof window||!document.head)return(0,o.nP)("load_fonts.failure",{sampleRate:1,tags:{failure_reason:"window undefined"}}),Promise.reject(Error("Window is undefined or no head on the document. Unable to load fonts"));var t=document.head,n=[];return e.forEach(function(e){e.styles.forEach(function(r){var o,a,l,s=document.querySelector("#".concat(null!=(o=e.fontFamily)?o:"","-").concat(r.name));s||((s=document.createElement("style")).setAttribute("id","".concat(null!=(a=e.fontFamily)?a:"","-").concat(r.name)),t.appendChild(s),e.format&&r.fontUrl&&s&&s.sheet&&s.sheet.insertRule('\n            @font-face {\n              font-family: "'.concat(null!=(l=e.fontFamily)?l:"",'";\n              font-style: "').concat(r.fontStyle,'";\n              font-weight: "').concat(r.fontWeight,'";\n              src: url("').concat(r.fontUrl,'") format("').concat(e.format,'");\n            }\n          '),0),n.push(new(i())(e.fontFamily,{style:r.fontStyle,weight:r.fontWeight}).load()))})}),Promise.all(n).then(function(){Promise.resolve()}).catch(function(e){(0,o.nP)("load_fonts.failure",{sampleRate:1,tags:{failure_reason:"unsuccessful load"}}),Promise.reject(e)})}},173922:function(e,t,n){var r=n(501010),i=n(774838),o=n(739405);t.Z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.skipExpActivation,n=(0,r.Z)().checkExperiment,a=(0,o.HG)();return(0,i.B)().isAuthenticated&&a?n("closeup_dweb_adaptive_images",{dangerouslySkipActivation:void 0!==t&&t}):{anyEnabled:!1,group:""}}},835531:function(e,t,n){n.d(t,{Z:function(){return d}});var r=n(387784),i=n(232079),o=n(680811);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var l=["alt","children","color","elementTiming","fetchPriority","isActive","naturalHeight","naturalWidth","onLoad","src","fit","srcSet"];function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach(function(t){var r,i;r=t,i=n[t],(r=function(e){var t=function(e,t){if("object"!=a(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=a(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==a(t)?t:t+""}(r))in e?Object.defineProperty(e,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[r]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var c=function(e,t,n){var i=(0,r.useRef)(null),o=(0,r.useRef)(null);(0,r.useEffect)(function(){if(e!==i.current||n&&n!==o.current){i.current=null!=e?e:null;var r=document.querySelector('img[src="'.concat(e,'"]'))||null;null!=r&&r.complete&&t()}o.current=n},[e,t,n])};function d(e){var t=e.alt,n=e.children,r=e.color,a=e.elementTiming,s=e.fetchPriority,d=e.isActive,p=e.naturalHeight,f=e.naturalWidth,h=e.onLoad,m=e.src,y=e.fit,g=e.srcSet,v=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if(({}).hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&({}).propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(e,l);return c(m,h,void 0!==d&&d),(0,o.jsx)(i.Z,u(u({},v),{},{alt:t,color:r,elementTiming:a,fetchPriority:s,fit:void 0===y?"none":y,naturalHeight:p,naturalWidth:f,onLoad:h,src:m,srcSet:g,children:n}))}},852796:function(e,t,n){n.d(t,{T:function(){return a},g:function(){return l}});var r=(0,n(439947).Z)({name:"story_pin_step",sampleRate:1}),i=r.Provider,o=r.get,a=i,l=o},410706:function(e,t,n){n.d(t,{Z:function(){return u}});var r=n(387784),i=n(20256),o=n(354553),a=n(59111),l=n(176783),s=n(680811);function u(e){var t=e.playing,n=e.zIndexValue;return(0,s.jsxs)(r.Fragment,{children:[(0,s.jsx)(a.Z,{unsafeCSS:"#story-pin-closeup-pause-play-overlay svg { filter: drop-shadow( 0px 0px 8px rgba(0,0,0,0.1));}"}),(0,s.jsx)(i.xu,{alignItems:"center",bottom:!0,dangerouslySetInlineStyle:{__style:{pointerEvents:"none"}},"data-test-id":"story-pin-closeup-pause-play-overlay",display:"flex",id:"story-pin-closeup-pause-play-overlay",justifyContent:"center",left:!0,opacity:.8,position:"absolute",right:!0,rounding:l.yR,top:!0,zIndex:n?new i.Ry(n):o.p8,children:!t&&(0,s.jsx)(i.JO,{accessibilityLabel:"Play",color:"light",icon:"play",size:48})})]})}},151383:function(e,t,n){n.d(t,{Z:function(){return b}});var r=n(387784),i=n(20256),o=n(24246),a=n(566431),l=n(151464),s=n(176783),u=n(967515),c=n(865043),d=n(736328),p=n(739405),f=n(764682),h=n(281213),m=n(113759),y=n(680811),g=function(){},v=function(e){var t=e.accessibilityLabel,n=e.dataTestId,r=e.disable,o=e.handleTap,a=e.icon;return(0,y.jsx)(i.xu,{"data-test-id":n,opacity:r?.5:void 0,children:(0,y.jsx)(i.iP,{disabled:r,onTap:o,children:(0,y.jsx)(i.JO,{accessibilityLabel:t,color:"light",icon:a,size:16})})})};function b(e){var t,n,b,_,x,P=e.activePageIndex,S=e.handlePanelChange,w=e.handlePlay,O=e.handlePause,j=e.handlePausePlay,E=e.handleMute,C=e.handleVideoScrubbingNewPage,T=e.handleWatchAgain,A=e.inMilliseconds,I=e.isPlaying,k=e.isMuted,R=e.isPanelOpen,M=e.pages,D=e.pageCount,L=e.pinId,F=void 0===L?"":L,z=e.progressInfo,V=e.showEndCard,B=e.showVideoControls,Z=void 0!==B&&B,H=e.viewParameter,G=e.isStoryPin,N=void 0===G||G,W=e.captionsUrl,U=(0,o.Z)(),K=(z||{}).currentTime,X=(0,u.Hx)().seekTimes,q=(0,m.x4)().closeupWithinMasonryEnabled,$=(0,h.H)(),J=(0,p.HG)(),Y=$.captionsEnabled,Q=(0,d.Z)(),ee=M[P],et=(ee||k).should_mute,en=Object.keys(X).includes(F)&&X[F]?X[F]:K,er=(0,r.useMemo)(function(){return M.map(function(e){var t,n,r,i,o,l,s,u=null==(t=e.blocks)?void 0:t.find(function(e){return 3===e.block_type}),c=(null==u||null==(n=u.video)||null==(r=n.video_list)||null==(i=r.V_HLSV3_MOBILE)?void 0:i.duration)||(null==u||null==(o=u.video)||null==(l=o.video_list)||null==(s=l.V_720P)?void 0:s.duration);return c?{duration:c,isVideo:!0}:{duration:a.oN,isVideo:!1}})},[M]),ei=[{duration:(null==z?void 0:z.duration)||0,isVideo:!0}],eo=N?er:ei,ea=null==(t=(ee&&(null==(_=ee.blocks)?void 0:_[0])||{}).video)||null==(n=t.video_list)||null==(b=n.V_HLSV3_MOBILE)?void 0:b.captions_urls,el=!1;(ea&&0!==Object.keys(ea).length||(void 0===W?"":W))&&(el=!0);var es=(0,r.useMemo)(function(){return eo.reduce(function(e,t){return e+(t.duration||0)},0)/(N?f.gJ:1)},[eo,N]),eu=(0,r.useMemo)(function(){return eo.filter(function(e,t){return t<P}).reduce(function(e,t){return e+(t.duration||0)},0)/f.gJ},[eo,P]),ec=eo.length>0&&null!=(x=eo[P])&&x.isVideo?null!=K?K:0:(null!=K?K:0)*5+(null!=eu?eu:0),ed=U._('Hide captions', 'gestalt.video.accessibilityHideCaptionsLabel', 'ARIA label for hide captions button'),ep=U._('Show captions', 'gestalt.video.accessibilityShowCaptionsLabel', 'ARIA label for show captions button');return(0,y.jsxs)(i.xu,{alignContent:"evenly",alignItems:"baseline",dangerouslySetInlineStyle:{__style:{gap:"18.5px",pointerEvents:"auto"}},direction:"column",display:"flex",justifyContent:"between",width:"100%",children:[(0,y.jsxs)(i.xu,{alignItems:"center",dangerouslySetInlineStyle:{__style:{opacity:Z||!I?1:0,transition:"all .1s"}},direction:"row",display:"flex",justifyContent:"between",width:"99%",children:[(0,y.jsxs)(i.kC,{alignItems:"center",direction:"row",gap:5,children:[(0,y.jsx)(v,{accessibilityLabel:I?U._('Pause', 'closeup.IdeaPinVideo.Pause', 'Pause button on Idea Pin video'):U._('Play', 'closeup.IdeaPinVideo.Play', 'Play button on Idea Pin video'),dataTestId:"story-pin-closeup-".concat(I?"pause":"play"),handleTap:V&&T?T:j,icon:I?"pause":"play"}),z&&(0,y.jsx)(i.iP,{children:(0,y.jsxs)(i.xu,{"aria-label":"".concat(U._('Video duration', 'closeup.IdeaPinVideo.durationLabel', 'Screen reader label for video duration display'),": ").concat((0,s.Lc)(ec)," of ").concat((0,s.Lc)(es)),"data-test-id":"time-display",children:[(0,y.jsx)(i.xv,{align:"end",color:"inverse",inline:!0,overflow:"normal",size:"300",weight:"bold",children:"".concat((0,s.Lc)(ec))})," ",(0,y.jsx)(i.xu,{display:"inlineBlock",opacity:.6,children:(0,y.jsx)(i.xv,{align:"end",color:"inverse",inline:!0,overflow:"normal",size:"300",weight:"bold",children:"/ ".concat((0,s.Lc)(es))})})]})})]}),(0,y.jsxs)(i.kC,{direction:"row",gap:5,children:[el&&(0,y.jsx)(v,{accessibilityLabel:Y?ep:ed,dataTestId:"closed-captions-button-".concat(Y?"disable":"enable"),handleTap:function(){var e=J?"desktop_pin_page":"mweb_pin_page";Y?(0,c.My)("".concat(e,".closed_captions_button.toggle_off")):(0,c.My)("".concat(e,".closed_captions_button.toggle_on")),Q({action:"click",item:"closed-captions-button"}),$.setCaptionsEnabled(!Y)},icon:Y?"captions":"captions-outline"}),(0,y.jsx)(v,{accessibilityLabel:k?U._('Unmute', 'closeup.IdeaPinVideo.unmute', 'Unmute button on Idea Pin video'):U._('Mute', 'closeup.IdeaPinVideo.mute', 'Mute button on Idea Pin video'),dataTestId:"story-pin-closeup-".concat(k?"unmute":"mute"),disable:et,handleTap:E,icon:k?"mute":"sound"}),S&&!q&&(0,y.jsx)(v,{accessibilityLabel:R?U._('Maximize', 'closeup.IdeaPinVideo.maximize', 'Maximize button on Idea Pin video'):U._('Minimize', 'closeup.IdeaPinVideo.minimize', 'Minimize button on Idea Pin video'),dataTestId:"story-pin-closeup-".concat(R?"maximize":"minimize"),handleTap:S||g,icon:R?"maximize":"minimize"})]})]}),(0,y.jsx)(l.ZP,{activePageCurrentTime:en,activePageIndex:P,duration:es,handlePause:O,handlePlay:w,handleVideoScrubbingNewPage:C,inMilliseconds:A,isPlaying:I,pageCount:D,pageDurations:eo,pinId:F,progressInfo:z,shouldShowPlayhead:!0,showEndCard:V,showVideoControls:Z,videoDurations:eo,viewParameter:H})]})}},151464:function(e,t,n){n.d(t,{$:function(){return g},$E:function(){return y},ZP:function(){return x}});var r=n(387784),i=n(20256),o=n(104999),a=n(24246),l=n(566431),s=n(774838),u=n(680811);function c(e){var t=e.pillHeight,n=e.scrubberWidth;return(0,u.jsx)(i.xu,{dangerouslySetInlineStyle:{__style:{backgroundColor:y}},display:"flex",flex:"grow",height:t,overflow:"hidden",rounding:"pill",children:(0,u.jsx)(i.xu,{color:g,dangerouslySetInlineStyle:{__style:{width:n}},"data-test-id":"video-progress-bar",height:"100%",rounding:"pill"})})}var d=n(967515),p=n(739405),f=n(764682);function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,l=[],s=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=o.call(n)).done)&&(l.push(r.value),l.length!==t);s=!0);}catch(e){u=!0,i=e}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return m(e,t);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(e,t):void 0}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var y="rgba(255,255,255,0.24)",g="light",v=function(){},b=function(e){var t=e.children,n=e.setHoveringChange,r=e.handleMouseDown,o=e.handleMouseLeave,l=e.handleTouchStart,s=e.playhead,c=e.isPlaying,d=e.showVideoControls,f=(0,a.Z)(),h=!(0,p.HG)();return(0,u.jsx)(i.iP,{children:(0,u.jsx)(i.xu,{ref:s,alignItems:"center","aria-label":f._('Video scrubber progress bar', 'ideaPin.closeupvideo.videoScrubberLabel', 'Accessibility label for video scrubber progress bar on video idea pins.'),dangerouslySetInlineStyle:{__style:{pointerEvents:"auto",touchAction:"none"}},"data-test-id":"bullet-video-progress-bar",display:"flex",flex:"grow",justifyContent:h?"center":"start",marginBottom:6*!h,minHeight:"8px",onFocus:n(!0),onMouseDown:r,onMouseLeave:o,onMouseOver:n(!0),onTouchEnd:function(e){return e.preventDefault()},onTouchStart:l,opacity:d||!c?1:0,paddingY:6*!!h,position:"relative",role:"progressbar",width:"100%",children:t})})},_=function(e){var t=e.isRTL,n=e.isSeeking,r=e.scrubberWidth;return(0,u.jsx)(i.xu,{dangerouslySetInlineStyle:{__style:t?{right:r}:{left:r}},"data-test-id":"video-progress-bar-playhead",position:"relative",children:(0,u.jsx)(i.xu,{color:g,height:4,position:"absolute",rounding:"pill",children:(0,u.jsx)(i.xu,{color:"light",dangerouslySetInlineStyle:{__style:{marginTop:n?-8:-6}},height:n?16:12,marginStart:-2,rounding:"circle",width:n?16:12})})})};function x(e){var t=e.activePageIndex,n=e.activePageCurrentTime,a=e.pageCount,m=e.progressInfo,y=e.showEndCard,x=e.duration,P=void 0===x?0:x,S=e.pageDurations,w=void 0===S?[]:S,O=e.handlePlay,j=void 0===O?v:O,E=e.handlePause,C=void 0===E?v:E,T=e.handleVideoScrubbingNewPage,A=void 0===T?v:T,I=e.inMilliseconds,k=e.videoDurations,R=void 0===k?[]:k,M=e.viewParameter,D=e.isInactiveStreamPin,L=void 0!==D&&D,F=e.isPlaying,z=void 0!==F&&F,V=e.setVideoProgress,B=e.shouldShowPlayhead,Z=void 0!==B&&B,H=e.showVideoControls,G=void 0===H||H,N=e.pinId,W=void 0===N?"":N,U=!(0,p.HG)(),K=(0,r.useRef)(null),X=(0,s.B)().isRTL,q=h((0,r.useState)(!1),2),$=q[0],J=q[1],Y=h((0,r.useState)(z),2),Q=Y[0],ee=Y[1],et=h((0,r.useState)(),2),en=et[0],er=et[1],ei=(0,o.Z)(),eo=h((0,r.useState)(!1),2),ea=eo[0],el=eo[1],es=(0,d.RC)(),eu=es.clearSeekTime,ec=es.updateSeekTime,ed=(0,r.useCallback)(function(e,n){if(!L&&n<=a){if(n!==t&&A(n),V){var r,i;V({currentTime:e/1e3,duration:R[n].isVideo?null!=(r=null==m?void 0:m.duration)?r:1:null!=(i=null==m?void 0:m.duration)?i:5,pinId:W})}ec(e/1e3,W)}ei({event_type:101,view_type:3,view_parameter:M,component:14302})},[t,A,L,ei,a,W,null==m?void 0:m.duration,V,ec,R,M]),ep=w.map(function(e){return"".concat((e.duration||0)/P/10,"%")}),ef=(0,r.useMemo)(function(){var e=0;return w.map(function(t){var n=t.duration+e,r={min:e,max:n};return e=n,r})},[w]),eh=$?"0 1.2px":"0 1px",em=function(e){return function(){return J(e)}},ey=(0,r.useCallback)(function(e){if(K.current){var t=K.current.getBoundingClientRect(),n=t.left,r=t.right,i=t.width,o=void 0===i?0:i,a=(X?Math.max(0,Math.min(((void 0===r?0:r)-e)/o,1)):Math.max(0,Math.min((e-(void 0===n?0:n))/o,1)))*P*1e3,l=ef.findIndex(function(e){return a>=e.min&&a<=e.max}),s=-1===l?0:l;ed(a-ef[s].min,s)}},[P,ed,ef,X]),eg=(0,r.useCallback)(function(){ea||ee(z||y),el(!0)},[ea,ee,z,y]),ev=(0,r.useCallback)(function(e){eg(),z&&C(),ey(e.pageX)},[eg,z,C,ey]),eb=(0,r.useCallback)(function(e){ea&&ey(e.pageX)},[ey,ea]),e_=(0,r.useCallback)(function(e){if(ea){e.preventDefault();var t=Array.from(e.changedTouches).find(function(e){return e.identifier===en});t&&ey(t.pageX)}},[ea,ey,en]),ex=(0,r.useCallback)(function(){em(!1),er(void 0),el(!1),Q&&j()},[j,Q]),eP=(0,r.useCallback)(function(e){Array.from(e.changedTouches).find(function(e){return e.identifier===en})&&(em(!1),er(void 0),el(!1),eu()),Q&&j()},[eu,j,Q,en]);return(0,r.useEffect)(function(){return ea&&!L&&(window.addEventListener("mousemove",eb),window.addEventListener("mouseup",ex),window.addEventListener("touchmove",e_),window.addEventListener("touchend",eP)),function(){window.removeEventListener("mousemove",eb),window.removeEventListener("mouseup",ex),window.removeEventListener("touchmove",e_),window.removeEventListener("touchend",eP)}},[eb,ex,eP,e_,L,ea,ey,Q,en]),(0,u.jsx)(b,{handleMouseDown:ev,handleMouseLeave:function(){em(!1)},handleTouchStart:function(e){eg(),em(!0);var t=e.changedTouches[0];er(t.identifier),ey(t.pageX)},isPlaying:z,playhead:K,setHoveringChange:em,showVideoControls:G,children:Array(a).fill(void 0).map(function(e,r){var o,s,d=null!=(o=null==m?void 0:m.currentTime)?o:0,p=null!=(s=null==m?void 0:m.duration)?s:l.P6,h=R[r],v="".concat(null!=h&&h.isVideo&&I?Math.floor(1e4*(null!=n?n:d)/(h.duration/f.gJ))/100:d/p*100,"%");return(0,u.jsx)(i.xu,{dangerouslySetInlineStyle:{__style:{margin:eh}},flex:"grow",width:ep.length===a?ep[r]:"auto",children:(0,u.jsx)(i.xu,{dangerouslySetInlineStyle:{__style:{transition:"all .1s"}},"data-test-id":"idea-pin-video-progress-bar",rounding:"pill",children:r<t||y?(0,u.jsx)(i.xu,{color:g,height:4,rounding:"pill"}):t===r&&m?(0,u.jsxs)(i.kC,{alignItems:"center",flex:"grow",children:[Z&&(G||$||ea||U)&&(0,u.jsx)(_,{isRTL:X,isSeeking:ea,scrubberWidth:v}),(0,u.jsx)(c,{pillHeight:4,scrubberWidth:v})]}):(0,u.jsx)(i.xu,{color:g,dangerouslySetInlineStyle:{__style:{opacity:.24}},height:4,rounding:"pill"})})},"".concat(W,"-").concat(r))})})}},450228:function(e,t,n){n.d(t,{BN:function(){return m},RK:function(){return h},d3:function(){return g},tq:function(){return v},xm:function(){return y}});var r=n(387784),i=n(295472),o=n(176783),a=n(408640),l=n(893957);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,l=[],s=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=o.call(n)).done)&&(l.push(r.value),l.length!==t);s=!0);}catch(e){u=!0,i=e}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return c(e,t);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach(function(t){var r,i;r=t,i=n[t],(r=function(e){var t=function(e,t){if("object"!=s(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=s(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==s(t)?t:t+""}(r))in e?Object.defineProperty(e,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[r]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var f=function(e,t){var n=(0,o.pE)(e,t);return"".concat(n.y,"px ").concat(n.x,"px")},h=function(e){var t=e.alignment,n=e.verticalAlignment,r={alignItems:"flex-start",display:"flex",height:"100%",justifyContent:"start",textAlign:"left",width:"100%"};return 1===n?r.alignItems="center":2===n&&(r.alignItems="flex-end"),1===t&&(r.justifyContent="center",r.textAlign="center"),r},m=function(e){var t=e.fontSize,n=e.hexColor,r=e.highlightColor,i=e.letterSpacing,o=e.lineHeight;return p({fontSize:t,letterSpacing:i,color:n,fontFamily:e.name,margin:0,maxHeight:"100%",textShadow:!r&&n&&"#ffffff"===n.toLowerCase()?"0px 1px 4px rgba(0, 0, 0, 0.2)":void 0,wordBreak:"break-word"},r?{backgroundColor:r,borderRadius:t/5,padding:f(t,o)}:{})},y=function(e){var t=e.fontSize,n=e.hasText,r=e.highlightColor,i=e.lineHeight;return p({},r?{backgroundColor:n?r:void 0,borderRadius:t/5,padding:f(t,i)}:{})},g=function(e){var t=e.letterSpacing,n=e.lineHeight;return{fontFamily:e.name,fontGroup:"",fontOverrides:{letterSpacing:t,lineHeight:n,textTransform:!1},format:"truetype",defaultStyle:0,styles:[{name:"Regular",fontStyle:"",fontWeight:"normal",fontUrl:e.url}]}};function v(e){var t=e.hasPin,n=e.pages,s=e.limitToSingleFont,c=u((0,r.useState)(!1),2),d=c[0],p=c[1],f=u((0,r.useState)(function(){return!!t&&(0,a.X7)(n)}),2),h=f[0],m=f[1],y=function(){var e=n.reduce(function(e,t){var n,r=(null==t||null==(n=t.blocks)?void 0:n.filter(function(e){return[o.h8.PARAGRAPH,o.h8.HEADING].includes(e.type)}))||[];return s&&r.length>1&&(r=[r[0]]),r.forEach(function(t){var n,r=(null==(n=t.style)?void 0:n.font)||o.Cc.font,i=r.name,a=void 0===i?"":i;e[a]||(e[a]=r)}),e},{});if(Object.keys(e).length>0){var t=Object.keys(e).map(function(t){var n=e[t];return g({letterSpacing:n.letter_spacing,lineHeight:n.line_height,name:n.name,url:n.url})});(0,i.Z)(t),p(!0)}};return(0,l.Z)(function(){y()}),(0,l.Z)(function(){h||y()}),(0,r.useEffect)(function(){h||m((0,a.X7)(n))},[h,n]),{fontsLoaded:d,mediaDataReceived:h}}},847195:function(e,t,n){n.d(t,{Z:function(){return r}});function r(e){var t=e.currentTime,n=e.endTime,r=e.startTime;return"number"!=typeof r||"number"!=typeof n||!(r>=0)||!(n>0)||!(r<n)||r<=t&&t<=n}},408640:function(e,t,n){n.d(t,{B7:function(){return s},X7:function(){return u},n4:function(){return l}});var r=n(176783);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t,n){return(t=a(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e){var t=function(e,t){if("object"!=i(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=i(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==i(t)?t:t+""}var l=function(e,t){var n=/^\d{1,3}\.\d{1,3}(?:\.\d{1,6})?$/;if(!(null!=e&&e.match(n))||!(null!=t&&t.match(n)))return null;for(var r=null==e?void 0:e.split("."),i=null==t?void 0:t.split("."),o=Math.max((null!=r?r:"").length,(null!=i?i:"").length),a=0;a<o;a+=1){var l,s,u,c,d=a<(null!=(l=null==r?void 0:r.length)?l:0)?parseInt(null!=(s=null==r?void 0:r[a])?s:"",10):0,p=a<(null!=(u=null==i?void 0:i.length)?u:0)?parseInt(null!=(c=null==i?void 0:i[a])?c:"",10):0;if(d<p)return -1;if(d>p)return 1}return 0},s=function(){var e;function t(e,n,r){var i=this;if(!(this instanceof t))throw TypeError("Cannot call a class as a function");o(this,"start",Date.now()),o(this,"paused",!1),this.onProgress=e,this.onComplete=n,this.duration=r,this.remaining=r,"undefined"!=typeof window&&(this.intervalId=window.setInterval(function(){var e=i.paused?i.duration-i.remaining:i.duration-i.remaining+(Date.now()-i.start);i.onProgress(e/i.duration)},500),this.resume())}return e=[{key:"currentTime",value:function(){return this.duration-this.remaining}},{key:"pause",value:function(){this.paused=!0,window.clearTimeout(this.timerId),this.remaining-=Date.now()-this.start;var e=this.duration-this.remaining;this.onProgress(e/this.duration)}},{key:"resume",value:function(){this.paused=!1,this.start=Date.now(),window.clearTimeout(this.timerId),this.timerId=window.setTimeout(this.onComplete,this.remaining)}},{key:"clear",value:function(){window.clearTimeout(this.timerId),window.clearInterval(this.intervalId)}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,a(r.key),r)}}(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}();function u(e){return e.some(function(e){var t;return(null!=(t=null==e?void 0:e.blocks)?t:[]).some(function(e){return e.type===r.h8.IMAGE&&!!e.image||e.type===r.h8.VIDEO&&(!!e.video||!!e.video_signature)})})}},605203:function(e,t,n){n.d(t,{Z:function(){return r}});function r(e){try{return decodeURIComponent(e)}catch(e){return null}}},780268:function(e,t,n){n.d(t,{Q:function(){return o},Z:function(){return a}});var r=["vHLSV3MOBILE"],i=function(){var e;return!(null!=(e=window)&&e.devicePixelRatio)||window.devicePixelRatio<=1?"1x":"2x"},o=function(){var e,t,n,r="undefined"!=typeof window?null==(e=window.navigator)||null==(t=e.connection)?void 0:t.effectiveType:void 0,o=i();return r?"4g"===r?n="40-80":(o="1x",n="0-1"):n="unknown",{downloadSpeedGroup:n,screenDimension:o}};function a(e){var t,n,i,a,l,s,u,c,d,p,f,h,m=e.vHLSV3MOBILE,y=(n=(t=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if(({}).hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&({}).propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(e,r)).vEXP3,i=t.vEXP4,a=t.vEXP5,l=t.vEXP6,s=t.vEXP7,u=t.v720P,d=(c=o()).downloadSpeedGroup,p=c.screenDimension,({unknown:f={"1x":n,"2x":a},"0-1":f,"1-5":{"1x":i,"2x":a},"5-10":{"1x":a,"2x":a},"10-20":{"1x":l,"2x":l},"20-40":h={"1x":s,"2x":s},"40-80":h,"80_or_above":h})[d][p]||u||void 0),g=m||void 0;return y?{hlsv3:g,mp4:y}:{hlsv3:g}}},264267:function(e,t,n){n.d(t,{pb:function(){return A},nf:function(){return I},lV:function(){return k}});var r=n(387784),i=n(581722),o=n(39801),a=n.n(o),l=n(27399),s=n(213491),u=n(681698),c=n(57887),d=n(360033),p=n(730056);function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach(function(t){y(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function y(e,t,n){var r;return(r=function(e,t){if("object"!=f(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=f(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==f(r)?r:r+"")in e)?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var g={feature_map:Object.freeze({})},v=function(e,t){var n=m(m(m(m({},(0,p.Z)(e,t)),t.reaction_counts?{reaction_counts:t.reaction_counts}:Object.freeze({})),t.tags?{tags:t.tags}:Object.freeze({})),t.tagged_users?{tagged_users:t.tagged_users}:Object.freeze({}));return(0,d.ZP)(e,n)?e:n},b=function(e,t){if(e=e||g,"FETCH_COMPLETE"===t.type){var n,r,i=t.payload,o=i.resource,a=i.options,l=void 0===a?{}:a,s=t.payload.response.resource_response.data;if("AggregatedCommentReplyFeedResource"===o||"ApiResource"===o&&l.url==="/v3/aggregated_comments/".concat(null==(n=l.data)?void 0:n.aggregated_comment,"/replies/")||"ApiResource"===o&&l.url==="/v3/aggregated_pin_data/".concat(null==(r=l.data)?void 0:r.aggregated_pin_data,"/comments/")||"DidItCommentsResource"===o){var u=(s||[]).reduce(function(t,n){return t[n.id]=v(e[n.id],n),t},{});return m(m({},e),u)}if("UnifiedCommentsResource"===o&&s&&s.length>0){var c=s.filter(function(e){return"aggregatedcomment"===e.type}).reduce(function(t,n){return t[n.id]=v(e[n.id],n),t},{});return m(m({},e),c)}if("UnifiedCommentsPreviewResource"===o&&s&&s.length>0){var d=s.map(function(e){return e.aggregated_comment}).reduce(function(t,n){return n&&(t[n.id]=v(e[n.id],n)),t},{}),p=s.map(function(e){return e.creator_reply}).reduce(function(t,n){return n&&n.id&&(t[n.id]=v(e[n.id],n)),t},{});return m(m(m({},e),d),p)}if("ApiResource"===o&&"/v3/aggregated_comments/features/"===l.url&&s&&Object.keys(s).length>0)return m(m({},e),{},{feature_map:s})}else if("AGGREGATED_COMMENT_CREATED"===t.type){var f=t.payload.aggregatedComment;return f.id?m(m({},e),{},y({},f.id,f)):e}else if("AGGREGATED_COMMENT_DELETED"===t.type||"AGGREGATED_COMMENT_HIDDEN"===t.type){var h=t.payload.aggregatedCommentId,b=m({},e);return delete b[h],b}else if("AGGREGATED_COMMENT_HIDDEN_FOR_USER"===t.type){var _=t.payload.userId;return Object.fromEntries(Object.entries(e).filter(function(e){var t;return(null==(t=e[1].user)?void 0:t.id)!==_}))}else if("AGGREGATED_COMMENT_UPDATED"===t.type){var x,P=t.payload.data;return m(m({},e),{},y({},P.id,v(null==(x=e)?void 0:x[P.id],P)))}else if("AGGREGATED_COMMENT_LIKE_TOGGLED"===t.type){var S,w=t.payload.data,O=null==(S=e)?void 0:S[w.id],j=(null==O?void 0:O.reaction_counts[1])||0,E=y({},1,w.reaction_by_me?j+1:j-1),C=m(m({},O),{},{reaction_by_me:w.reaction_by_me,reaction_counts:E});return m(m({},e),{},y({},w.id,C))}else if("AGGREGATED_COMMENT_HELPFUL_TOGGLED"===t.type){var T,A=t.payload.data,I=null==(T=e)?void 0:T[A.id],k=(null==I?void 0:I.helpful_count)||0,R=A.marked_helpful_by_me?k+1:k-1,M=m(m({},I),{},{marked_helpful_by_me:A.marked_helpful_by_me,helpful_count:R});return m(m({},e),{},y({},A.id,M))}else if("AGGREGATED_COMMENT_HIGHLIGHT_TOGGLED"===t.type){var D,L=t.payload.data,F=m(m({},null==(D=e)?void 0:D[L.aggregated_comment_id]),{},{highlighted_by_pin_owner:L.is_highlighted});return m(m({},e),{},y({},L.aggregated_comment_id,F))}else if("AGGREGATED_COMMENT_FEATURES_UPDATED"===t.type){var z,V=t.payload.data.featureMap;return m(m({},e),{},{feature_map:m(m({},null==(z=e)?void 0:z.feature_map),V)})}else if("UPDATE_AGGREGATED_COMMENT_COMMENT_COUNT"===t.type){var B,Z=t.payload,H=Z.increment,G=Z.id,N=null==(B=e)?void 0:B[G];if(!N)return e;var W=m(m({},N),{},{comment_count:N.comment_count+H});return m(m({},e),{},y({},G,W))}else if("DELETE_COMMENT_MENTION"===t.type){var U,K=t.payload,X=K.aggregatedCommentId,q=K.tagged_users,$=m(m({},null==(U=e)?void 0:U[X]),{},{tagged_users:q});return m(m({},e),{},y({},X,$))}else if("GET_COMMENT_TRANSLATION"===t.type){var J,Y=t.payload,Q=Y.aggregatedCommentId,ee=Y.translatedText,et=m(m({},null==(J=e)?void 0:J[Q]),{},{translatedText:ee});return m(m({},e),{},y({},Q,et))}return e},_=n(680811);function x(e){return(x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function P(e,t,n,r,i,o,a){try{var l=e[o](a),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(r,i)}function S(e){return function(){var t=this,n=arguments;return new Promise(function(r,i){var o=e.apply(t,n);function a(e){P(o,r,i,a,l,"next",e)}function l(e){P(o,r,i,a,l,"throw",e)}a(void 0)})}}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach(function(t){var r,i;r=t,i=n[t],(r=function(e){var t=function(e,t){if("object"!=x(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=x(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==x(t)?t:t+""}(r))in e?Object.defineProperty(e,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[r]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var E=(0,s.Z)("AggregatedComments"),C=E.Provider,T=E.get;function A(e){var t,n=e.children,o=(0,i.v9)(function(e){var t=e.resources;return null==t?void 0:t.UnifiedCommentsResource}),a=g;o&&Object.values(o).forEach(function(e){var t,n=null==(t=e.data)?void 0:t.filter(function(e){return"aggregatedcomment"===e.type}),r=null==n?void 0:n.reduce(function(e,t){return e[t.id]=v(a[t.id],t),e},{});a=j(j({},a),r)});var l=function(e){if(Array.isArray(e))return e}(t=(0,r.useReducer)(b,a))||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,l=[],s=!0,u=!1;try{for(o=(n=n.call(e)).next;!(s=(r=o.call(n)).done)&&(l.push(r.value),2!==l.length);s=!0);}catch(e){u=!0,i=e}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return l}}(t,2)||function(e,t){if(e){if("string"==typeof e)return w(e,2);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?w(e,2):void 0}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),s=l[0],u=l[1],d=function(e){u({type:"FETCH_COMPLETE",payload:e})};(0,c.Z8)("AggregatedCommentReplyFeedResource",d),(0,c.my)("AggregatedCommentReplyFeedResource",d),(0,c.Z8)("ApiResource",d),(0,c.my)("ApiResource",d),(0,c.Z8)("DidItCommentsResource",d),(0,c.my)("DidItCommentsResource",d),(0,c.Z8)("UnifiedCommentsPreviewResource",d),(0,c.my)("UnifiedCommentsPreviewResource",d),(0,c.Z8)("UnifiedCommentsResource",d),(0,c.my)("UnifiedCommentsResource",d);var p=(0,r.useMemo)(function(){return{aggregatedComments:s,dispatch:u}},[s,u]);return(0,_.jsx)(C,{value:p,children:n})}function I(){var e=T().dispatch;return(0,r.useMemo)(function(){var t,n,r,i,o,s;return{aggregatedCommentCreated:function(t,n){e({type:"AGGREGATED_COMMENT_CREATED",payload:{parentId:t,aggregatedComment:n}})},aggregatedCommentDeleted:function(t,n){e({type:"AGGREGATED_COMMENT_DELETED",payload:{parentId:t,aggregatedCommentId:n}})},aggregatedCommentHidden:function(t){e({type:"AGGREGATED_COMMENT_HIDDEN",payload:{aggregatedCommentId:t}})},aggregatedCommentsHiddenForUser:function(t){e({type:"AGGREGATED_COMMENT_HIDDEN_FOR_USER",payload:{userId:t}})},flagAggregatedComment:(t=S(regeneratorRuntime.mark(function e(t){var n,r,i,o,a,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=void 0===(n=t.isAggregatedComment)||n,i=t.commentId,o=t.reason,a=t.detailedReasons,l=r?"/v3/aggregated_comments/".concat(i,"/flag/"):"/v3/did_it/".concat(i,"/flag/"),e.abrupt("return",(0,u.Z)({url:l,method:"PUT",data:{commentId:i,reason:o,detailedReasons:a}}));case 3:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)}),deleteCommentMention:(n=S(regeneratorRuntime.mark(function t(n){var r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,u.Z)({url:"/v3/aggregated_comments/".concat(n,"/mentions/"),method:"DELETE",data:{fields:["aggregatedcomment.id","aggregatedcomment.tagged_users"]}});case 2:e({type:"DELETE_COMMENT_MENTION",payload:{aggregatedCommentId:(i=null!=(r=t.sent.resource_response.data)?r:{}).id,tagged_users:i.tagged_users}});case 6:case"end":return t.stop()}},t)})),function(e){return n.apply(this,arguments)}),translateAggregatedComment:(r=S(regeneratorRuntime.mark(function t(n){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,(0,u.Z)({url:"/v3/aggregated_comments/".concat(n,"/translate/"),method:"GET"});case 3:e({type:"GET_COMMENT_TRANSLATION",payload:{aggregatedCommentId:n,translatedText:null!=(r=t.sent.resource_response.data)?r:""}}),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(0),e({type:"GET_COMMENT_TRANSLATION",payload:{aggregatedCommentId:n,translatedText:""}});case 13:case"end":return t.stop()}},t,null,[[0,9]])})),function(e){return r.apply(this,arguments)}),toggleAggregatedCommentHelpful:function(t){var n=t.aggregatedCommentId,r=t.isMarkedHelpfulByMe,i=t.orbacSubjectId;(0,u.Z)({url:"/v3/helpful/1/".concat(n,"/"),method:r?"DELETE":"POST",data:i?{orbac_subject_id:i}:{}}),e({type:"AGGREGATED_COMMENT_HELPFUL_TOGGLED",payload:{data:{id:n,marked_helpful_by_me:!r}}})},toggleAggregatedCommentHighlight:(i=S(regeneratorRuntime.mark(function t(n){var r,i,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.aggregatedCommentId,i=n.pinId,o=n.isHighlighted,a()(r,"Could not find comment"),a()(i,"Could not find Pin"),t.next=5,(0,u.Z)({url:"/v3/aggregated_comments/pin/highlight/",method:"PUT",data:{aggregated_comment:r,pin:i,highlight:!o}});case 5:e({type:"AGGREGATED_COMMENT_HIGHLIGHT_TOGGLED",payload:{data:{aggregated_comment_id:r,pin_id:i,is_highlighted:!o}}});case 6:case"end":return t.stop()}},t)})),function(e){return i.apply(this,arguments)}),toggleAggregatedCommentLike:function(t){var n=t.aggregatedCommentId,r=t.isLikedByMe,i=t.orbacSubjectId;(0,u.Z)({url:"/v3/aggregated_comments/".concat(n,"/react/"),method:r?"DELETE":"POST",data:j({reaction_type:1},i?{orbac_subject_id:i}:{})}),e({type:"AGGREGATED_COMMENT_LIKE_TOGGLED",payload:{data:{id:n,reaction_by_me:+!r}}})},updateAggregatedComment:(o=S(regeneratorRuntime.mark(function t(n){var r,i,o,a,s,u,c;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=n.commentId,o=n.force,a=n.orbacSubjectId,s=n.tags,u=n.text,t.next=3,l.Z.create("AggregatedCommentResource",j({commentId:i,force:o,tags:s,text:u},a?{orbacSubjectId:a}:{})).callUpdate({showError:!1});case 3:c=(null!=(r=t.sent.resource_response.data)?r:{}).tagged_users.map(function(e){return j({},e)}),e({type:"AGGREGATED_COMMENT_UPDATED",payload:{data:{id:i,tagged_users:c,tags:JSON.parse(s),text:u}}});case 8:case"end":return t.stop()}},t)})),function(e){return o.apply(this,arguments)}),updateAggregatedCommentFeatures:(s=S(regeneratorRuntime.mark(function t(n){var r,i,o,a,l;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=n.userId,o=n.featureMap,a=n.passcode,l=n.userConfirmPasscode,t.next=3,(0,u.Z)({url:"/v3/aggregated_comments/features/",method:"PUT",data:{user:i,feature_map:JSON.stringify(o),passcode:a,user_confirm_skip_passcode:null!=l&&l}});case 3:e({type:"AGGREGATED_COMMENT_FEATURES_UPDATED",payload:{data:{featureMap:null!=(r=t.sent.resource_response.data)?r:Object.freeze({})}}});case 7:case"end":return t.stop()}},t)})),function(e){return s.apply(this,arguments)}),updateCommentCount:function(t,n){e({type:"UPDATE_AGGREGATED_COMMENT_COMMENT_COUNT",payload:{increment:n,id:t}})}}},[e])}function k(){return T().aggregatedComments}},957591:function(e,t,n){n.d(t,{c:function(){return d},f:function(){return c}});var r=n(387784),i=n(213491),o=n(680811);function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,l=[],s=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=o.call(n)).done)&&(l.push(r.value),l.length!==t);s=!0);}catch(e){u=!0,i=e}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return l(e,t);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,t):void 0}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var s=(0,i.Z)("CloseupAnimations"),u=s.Provider,c=s.get;function d(e){var t=e.children,n=a((0,r.useState)(!1),2),i=n[0],l=n[1],s=a((0,r.useState)(!1),2),c=s[0],d=s[1],p=(0,r.useMemo)(function(){return{isShowingShareButton:i,setIsShowingShareButton:l,isShowingVisualSearchButton:c,setIsShowingVisualSearchButton:d}},[i,c]);return(0,o.jsx)(u,{value:p,children:t})}},975703:function(e,t,n){n.d(t,{C:function(){return u},K:function(){return s}});var r=n(387784),i=n(680811);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,l=[],s=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=o.call(n)).done)&&(l.push(r.value),l.length!==t);s=!0);}catch(e){u=!0,i=e}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return a(e,t);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var l=(0,r.createContext)({closeupBodyWidth:0,isCollageOverlayOpen:!1,isRelatedPins10PercentVisible:!1,setCloseupBodyWidth:function(){},setIsCollageOverlayOpen:function(){},setIsRelatedPins10PercentVisible:function(){}});function s(){var e=(0,r.useContext)(l);if(!e)throw Error("useCloseupBodyContext must be used within CloseupBodyContextProvider");return e}function u(e){var t=e.children,n=o((0,r.useState)(0),2),a=n[0],s=n[1],u=o((0,r.useState)(!1),2),c=u[0],d=u[1],p=o((0,r.useState)(!1),2),f=p[0],h=p[1],m=(0,r.useMemo)(function(){return{closeupBodyWidth:a,setCloseupBodyWidth:s,isCollageOverlayOpen:c,setIsCollageOverlayOpen:d,isRelatedPins10PercentVisible:f,setIsRelatedPins10PercentVisible:h}},[a,c,f]);return(0,i.jsx)(l,{value:m,children:t})}},398542:function(e,t,n){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach(function(t){var i,o;i=t,o=n[t],(i=function(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=r(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}(i))in e?Object.defineProperty(e,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[i]=o}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}n.d(t,{Z:function(){return h}});var a={WebkitMaskImage:"-webkit-radial-gradient(white, black)"},l=function(e){return"".concat(null!=e?e:0,"px")},s=function(e){var t=e.topLeft,n=e.topRight,r=e.bottomRight,i=e.bottomLeft;return"".concat(l(t)," ").concat(l(n)," ").concat(l(r)," ").concat(l(i))},u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.additionalPadding,n=void 0===t?0:t;return{borderRadius:s({topLeft:32+n,topRight:32+n,bottomRight:0,bottomLeft:0}),borderRadiusNumeric:32+n}},c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.additionalPadding,n=void 0===t?0:t;return{borderRadius:s({topLeft:24+n,topRight:24+n,bottomRight:24+n,bottomLeft:24+n}),borderRadiusNumeric:24+n}},d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.additionalPadding,n=void 0===t?0:t;return{borderRadius:s({topLeft:32+n,topRight:0,bottomRight:0,bottomLeft:32+n}),borderRadiusNumeric:32+n}},p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.additionalPadding,n=void 0===t?0:t;return{borderRadius:s({topLeft:0,topRight:32+n,bottomRight:32+n,bottomLeft:0}),borderRadiusNumeric:32+n}},f=function(e){var t=e.getterOptions,n=e.isPadded,r=e.isRTL;return n?c(t):r?p(t):d(t)};function h(e){var t=e.additionalPadding,n=e.isSideBySide,r=e.isPadded,i=e.isRTL,l=e.closeupWithinMasonryEnabled,s=e.blendedUIEnabled,d={additionalPadding:t};if(void 0!==s&&s)return{borderStyle:o(o({},a),{},{borderRadius:"unset"}),borderRadiusNumeric:0};if(void 0!==l&&l)return{borderStyle:o(o({},a),{},{borderRadius:"".concat(24,"px")}),borderRadiusNumeric:24};if(n){var p=f({isPadded:r,isRTL:i,getterOptions:d}),h=p.borderRadius,m=p.borderRadiusNumeric;return{borderStyle:o(o({},a),{},{borderRadius:h}),borderRadiusNumeric:m}}var y=(r?c:u)(d),g=y.borderRadius,v=y.borderRadiusNumeric;return{borderStyle:o(o({},a),{},{borderRadius:g}),borderRadiusNumeric:v}}},884541:function(e,t,n){function r(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return i(e,void 0);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,void 0):void 0}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}n.d(t,{GL:function(){return s},_z:function(){return a},d0:function(){return c},hO:function(){return u},pM:function(){return l}});var o,a="video",l="image",s=new Map([["DEFAULT",new Set(["button"])],["story_pin",new Set([a])],["product_detail_page",new Set(["description","shopButton","thumbnailsLoaded"])],["product_detail_page_plus",new Set(["description","shopButton","thumbnailsLoaded"])]]),u=(o=new Set,s.forEach(function(e){o=new Set([].concat(r(o),r(e)))}),o),c=new Set([].concat(r(u),[l,"resource"]))},590940:function(e,t,n){n.d(t,{Z:function(){return i}});var r=n(978097);function i(e){var t;return{defaultStyle:0,fontFamily:null!=(t=e.name)?t:"",fontGroup:r.gu,fontOverrides:{letterSpacing:e.letter_spacing,lineHeight:e.line_height},format:"truetype",id:e.id,styles:[{fontStyle:"",fontUrl:e.url,fontWeight:"normal",name:"normal"}]}}},793301:function(e,t,n){n.d(t,{Z:function(){return o}});var r=n(560619),i=n(677269);function o(e,t){(0,i.Z)(2,arguments);var n=(0,r.Z)(e),o=(0,r.Z)(t);return n.getTime()===o.getTime()}}}]);